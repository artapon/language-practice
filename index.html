<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸ¼ å°ç†Šå­¦æ±‰å­— Â· Chinese for Kids!</title>
<link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800;900&family=Noto+Serif+SC:wght@400;700&family=Noto+Sans+SC:wght@400;500&display=swap" rel="stylesheet">
<style>
:root {
  --sky:    #e0f4ff;
  --pink:   #ff6eb4;
  --yellow: #ffd94a;
  --green:  #4ecb6e;
  --blue:   #4ab3f4;
  --orange: #ff8c42;
  --purple: #b388ff;
  --red:    #ff5252;
  --white:  #ffffff;
  --ink:    #2d2d6b;
  --soft:   #f0f8ff;
  --border-r: 18px;
  --shadow-fun: 0 6px 0 rgba(0,0,0,0.12);
  --shadow-card: 0 8px 24px rgba(100,100,200,0.13);
}

* { box-sizing: border-box; margin: 0; padding: 0; }
html, body { height: 100%; }

body {
  background: var(--sky);
  background-image:
    radial-gradient(circle at 10% 15%, rgba(255,110,180,0.18) 0%, transparent 35%),
    radial-gradient(circle at 90% 10%, rgba(74,179,244,0.2) 0%, transparent 30%),
    radial-gradient(circle at 80% 85%, rgba(78,203,110,0.15) 0%, transparent 30%),
    radial-gradient(circle at 20% 80%, rgba(255,213,74,0.2) 0%, transparent 30%);
  font-family: 'Nunito', sans-serif;
  color: var(--ink);
  display: flex;
  flex-direction: column;
  height: 100vh;
  overflow: hidden;
}

/* floating stars background */
body::before {
  content: 'â­ ğŸŒŸ âœ¨ â­ ğŸŒŸ âœ¨ â­ ğŸŒŸ';
  position: fixed;
  top: 0; left: 0; right: 0;
  font-size: 1.2rem;
  letter-spacing: 4rem;
  opacity: 0.07;
  pointer-events: none;
  white-space: nowrap;
  overflow: hidden;
  padding: 0.5rem 0;
}

/* â”€â”€ TOP BAR â”€â”€ */
.topbar {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0.5rem 1rem;
  background: linear-gradient(135deg, #ff6eb4 0%, #ff8c42 50%, #ffd94a 100%);
  flex-shrink: 0;
  gap: 0.5rem;
  flex-wrap: wrap;
  box-shadow: 0 4px 0 rgba(0,0,0,0.1);
  position: relative;
  z-index: 10;
}

.topbar::after {
  content: '';
  position: absolute;
  bottom: -8px; left: 0; right: 0;
  height: 8px;
  background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='40' height='8'%3E%3Cpath d='M0 0 Q10 8 20 0 Q30 8 40 0' fill='none' stroke='%23ff6eb4' stroke-width='2'/%3E%3C/svg%3E") repeat-x;
  opacity: 0.4;
}

.topbar h1 {
  font-family: 'Nunito', sans-serif;
  font-size: 1.4rem;
  font-weight: 900;
  color: white;
  text-shadow: 0 3px 0 rgba(0,0,0,0.15);
  white-space: nowrap;
  letter-spacing: 0.02em;
}
.topbar h1 .emoji { font-size: 1.5rem; margin-right: 0.2rem; }
.topbar h1 span { color: #fff9c4; }

.topbar-controls {
  display: flex; gap: 0.4rem; align-items: center; flex-wrap: wrap;
}

.topbar select {
  background: rgba(255,255,255,0.9);
  border: 3px solid rgba(255,255,255,0.6);
  color: var(--ink);
  font-family: 'Nunito', sans-serif;
  font-size: 0.82rem;
  font-weight: 700;
  padding: 0.3rem 0.6rem;
  border-radius: 30px;
  cursor: pointer;
  box-shadow: 0 3px 0 rgba(0,0,0,0.1);
}

.btn {
  font-family: 'Nunito', sans-serif;
  font-size: 0.82rem;
  font-weight: 800;
  padding: 0.35rem 0.8rem;
  border-radius: 30px;
  border: 3px solid rgba(255,255,255,0.5);
  background: rgba(255,255,255,0.25);
  color: white;
  cursor: pointer;
  white-space: nowrap;
  transition: all 0.15s;
  box-shadow: 0 3px 0 rgba(0,0,0,0.1);
  text-shadow: 0 1px 0 rgba(0,0,0,0.1);
}
.btn:hover { background: rgba(255,255,255,0.45); transform: translateY(-1px); }
.btn:active { transform: translateY(2px); box-shadow: none; }
.btn.red { background: var(--red); border-color: #ff8a80; }
.btn.red:hover { background: #ff6e6e; }

.brush-wrap {
  display: flex; align-items: center; gap: 0.3rem;
  font-size: 0.78rem; color: white; font-weight: 700;
  background: rgba(255,255,255,0.2);
  border-radius: 30px; padding: 0.2rem 0.6rem;
  border: 2px solid rgba(255,255,255,0.4);
}
input[type=range] { width: 60px; accent-color: white; }
.progress-txt {
  font-size: 0.78rem; color: white; font-weight: 800;
  background: rgba(255,255,255,0.25);
  padding: 0.2rem 0.7rem; border-radius: 20px;
  white-space: nowrap;
}

/* â”€â”€ LAYOUT â”€â”€ */
.app { display: flex; flex: 1; overflow: hidden; }

/* â”€â”€ LEFT SIDEBAR â”€â”€ */
.sidebar {
  width: 200px;
  flex-shrink: 0;
  background: white;
  display: flex;
  flex-direction: column;
  overflow: hidden;
  border-right: 4px solid #ffe0f0;
  box-shadow: 4px 0 12px rgba(255,110,180,0.08);
}

.sidebar-header {
  background: linear-gradient(135deg, #b388ff, #4ab3f4);
  padding: 0.6rem 0.7rem 0.5rem;
  color: white;
  font-weight: 800;
  font-size: 0.8rem;
  letter-spacing: 0.05em;
  text-align: center;
}

.sidebar-search {
  padding: 0.5rem;
  background: #f8f0ff;
  border-bottom: 3px solid #ede0ff;
}
.sidebar-search input {
  width: 100%;
  padding: 0.4rem 0.7rem;
  border: 3px solid #c9a8ff;
  border-radius: 20px;
  font-family: 'Nunito', sans-serif;
  font-size: 0.82rem;
  font-weight: 700;
  background: white;
  color: var(--ink);
  outline: none;
}
.sidebar-search input:focus { border-color: var(--purple); box-shadow: 0 0 0 3px rgba(179,136,255,0.2); }

.char-grid {
  flex: 1;
  overflow-y: auto;
  padding: 0.5rem;
  display: flex;
  flex-wrap: wrap;
  gap: 4px;
  align-content: flex-start;
  background: #fdfaff;
}
.char-grid::-webkit-scrollbar { width: 6px; }
.char-grid::-webkit-scrollbar-thumb { background: #c9a8ff; border-radius: 10px; }
.char-grid::-webkit-scrollbar-track { background: #f0e8ff; }

.cpill {
  font-family: 'Noto Serif SC', serif;
  font-size: 1.1rem;
  width: 38px; height: 38px;
  display: flex; align-items: center; justify-content: center;
  border: 3px solid #e8d5ff;
  border-radius: 12px;
  cursor: pointer;
  background: white;
  transition: all 0.15s;
  position: relative;
  box-shadow: 0 3px 0 rgba(179,136,255,0.2);
  color: var(--ink);
}
.cpill:hover {
  border-color: var(--pink);
  transform: translateY(-2px) scale(1.05);
  box-shadow: 0 5px 0 rgba(255,110,180,0.25);
  background: #fff0f8;
}
.cpill.active {
  background: linear-gradient(135deg, var(--pink), var(--orange));
  color: white;
  border-color: transparent;
  box-shadow: 0 4px 0 rgba(255,110,180,0.4);
  transform: translateY(-1px);
}
.cpill.done::after {
  content: 'â­';
  position: absolute;
  bottom: -4px; right: -4px;
  font-size: 0.6rem;
  line-height: 1;
}
.cpill.active.done::after { filter: brightness(1.5); }

/* â”€â”€ CENTER â”€â”€ */
.center {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 1rem;
  padding: 1rem 0.8rem 2rem;
  overflow: auto;
}

.practice-row {
  display: flex;
  gap: 1.5rem;
  align-items: flex-start;
  flex-wrap: wrap;
  justify-content: center;
}

/* â”€â”€ REFERENCE BOX â”€â”€ */
.ref-box {
  display: flex; flex-direction: column; align-items: center; gap: 0.6rem;
}

.ref-label {
  font-size: 0.72rem;
  font-weight: 800;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  color: var(--purple);
  background: white;
  padding: 0.2rem 0.8rem;
  border-radius: 20px;
  border: 3px solid #e8d5ff;
  box-shadow: 0 3px 0 rgba(179,136,255,0.2);
}

.ref-char {
  min-width: 160px; height: 160px;
  max-width: 400px;
  border: 4px solid transparent;
  background: linear-gradient(white, white) padding-box,
              linear-gradient(135deg, var(--pink), var(--yellow), var(--green), var(--blue)) border-box;
  border-radius: 24px;
  box-shadow: var(--shadow-card), 0 6px 0 rgba(255,110,180,0.2);
  display: flex; align-items: center; justify-content: center;
  flex-wrap: wrap;
  font-family: 'Noto Serif SC', serif;
  font-size: 110px;
  line-height: 1;
  position: relative;
  overflow: hidden;
  padding: 4px 10px;
  transition: transform 0.2s;
}
.ref-char:hover { transform: scale(1.03) rotate(-1deg); }
.ref-char::before, .ref-char::after {
  content: ''; position: absolute;
  background: rgba(179,136,255,0.12);
}
.ref-char::before { width: 100%; height: 1px; top: 50%; }
.ref-char::after { height: 100%; width: 1px; left: 50%; }

.ref-info { text-align: center; }
.ref-pinyin {
  font-size: 1.1rem;
  font-weight: 800;
  color: var(--pink);
  letter-spacing: 0.05em;
}
.ref-meaning {
  font-size: 0.82rem;
  font-weight: 600;
  color: #7a7aaa;
  margin-top: 0.2rem;
  max-width: 180px;
  background: white;
  border-radius: 12px;
  padding: 0.2rem 0.6rem;
  border: 2px solid #e8f4ff;
}

.ref-nav { display: flex; gap: 0.5rem; margin-top: 0.2rem; }
.ref-nav button {
  font-family: 'Nunito', sans-serif;
  font-size: 0.9rem;
  font-weight: 800;
  padding: 0.4rem 0.9rem;
  border-radius: 20px;
  border: 3px solid transparent;
  cursor: pointer;
  transition: all 0.15s;
  box-shadow: 0 4px 0 rgba(0,0,0,0.1);
  color: white;
}
.ref-nav button:first-child  { background: var(--blue); border-color: #81d4fa; }
.ref-nav button:nth-child(2) { background: var(--yellow); border-color: #ffe082; color: var(--ink); }
.ref-nav button:last-child   { background: var(--green); border-color: #a5d6a7; }
.ref-nav button:hover { transform: translateY(-2px); filter: brightness(1.08); }
.ref-nav button:active { transform: translateY(2px); box-shadow: none; }

/* â”€â”€ CANVAS â”€â”€ */
.canvas-box { display: flex; flex-direction: column; align-items: center; gap: 0.7rem; }

.canvas-label {
  font-size: 0.72rem;
  font-weight: 800;
  letter-spacing: 0.12em;
  text-transform: uppercase;
  color: white;
  background: linear-gradient(135deg, var(--orange), var(--pink));
  padding: 0.2rem 0.8rem;
  border-radius: 20px;
  box-shadow: 0 3px 0 rgba(255,140,66,0.3);
}

.canvas-wrap {
  position: relative;
  border: 4px solid transparent;
  background: linear-gradient(white, white) padding-box,
              linear-gradient(135deg, var(--orange), var(--pink), var(--purple)) border-box;
  border-radius: 24px;
  box-shadow: var(--shadow-card), 0 6px 0 rgba(255,140,66,0.2);
  overflow: hidden;
  cursor: crosshair;
  touch-action: none;
}
.grid-overlay { position: absolute; inset: 0; pointer-events: none; z-index: 1; }
.ghost {
  position: absolute; inset: 0;
  display: flex; align-items: center; justify-content: center;
  font-family: 'Noto Serif SC', serif;
  pointer-events: none; z-index: 0;
  transition: opacity 0.3s;
  user-select: none;
  color: rgba(179,136,255,0.12);
  line-height: 1;
  overflow: hidden;
}
canvas { position: absolute; inset: 0; z-index: 2; display: block; }

.canvas-btns { display: flex; gap: 0.5rem; flex-wrap: wrap; justify-content: center; }
.canvas-btns button {
  font-family: 'Nunito', sans-serif;
  font-size: 0.82rem;
  font-weight: 800;
  padding: 0.4rem 0.9rem;
  border-radius: 20px;
  border: 3px solid transparent;
  cursor: pointer;
  transition: all 0.15s;
  box-shadow: 0 4px 0 rgba(0,0,0,0.1);
  color: white;
}
#undoBtn2 { background: var(--blue); border-color: #81d4fa; }
#clearBtn2 { background: var(--orange); border-color: #ffcc80; }
#nextCharBtn { background: linear-gradient(135deg, var(--green), var(--blue)) !important;
               border-color: transparent !important; color: white !important; }
.canvas-btns button:hover { transform: translateY(-2px); filter: brightness(1.08); }
.canvas-btns button:active { transform: translateY(2px); box-shadow: none; }

/* â”€â”€ YOUTUBE PANEL â”€â”€ */
.yt-panel {
  background: white;
  border: 4px solid #ffd4ee;
  border-radius: 20px;
  overflow: hidden;
  width: 100%;
  max-width: 480px;
  box-shadow: 0 6px 0 rgba(255,110,180,0.15), var(--shadow-card);
}
.yt-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0.5rem 0.8rem;
  background: linear-gradient(135deg, #ff6eb4, #ff8c42);
  color: white;
  gap: 0.4rem;
  flex-wrap: wrap;
}
.yt-header-left {
  display: flex; align-items: center; gap: 0.4rem;
  font-size: 0.78rem; font-weight: 800;
}
.yt-logo { font-size: 1.1rem; }
.yt-char-label {
  font-family: 'Noto Serif SC', serif;
  font-size: 1.1rem;
  background: rgba(255,255,255,0.25);
  padding: 0 0.4rem;
  border-radius: 8px;
}
.yt-links { display: flex; gap: 0.3rem; flex-wrap: wrap; }
.yt-link {
  font-family: 'Nunito', sans-serif;
  font-size: 0.68rem;
  font-weight: 800;
  padding: 0.2rem 0.5rem;
  border-radius: 14px;
  border: 2px solid rgba(255,255,255,0.4);
  background: rgba(255,255,255,0.18);
  color: white;
  cursor: pointer;
  text-decoration: none;
  transition: all 0.15s;
  white-space: nowrap;
}
.yt-link:hover { background: rgba(255,255,255,0.35); }
.yt-link.active-link { background: white; color: var(--pink); border-color: white; }
.yt-embed-wrap {
  position: relative;
  width: 100%;
  padding-bottom: 52%;
  background: #fff5fb;
}
.yt-embed-wrap iframe { position: absolute; inset: 0; width: 100%; height: 100%; border: none; }
.yt-placeholder {
  position: absolute; inset: 0;
  display: flex; flex-direction: column;
  align-items: center; justify-content: center;
  background: linear-gradient(135deg, #fff0f8, #f0f8ff);
  color: #c9a8ff;
  font-size: 0.78rem;
  font-weight: 700;
  gap: 0.4rem;
  cursor: pointer;
}
.yt-placeholder-char {
  font-family: 'Noto Serif SC', serif;
  font-size: 3.5rem;
  color: rgba(179,136,255,0.15);
  position: absolute;
  top: 50%; transform: translateY(-60%);
  pointer-events: none; user-select: none;
}
.play-btn {
  width: 48px; height: 48px;
  background: linear-gradient(135deg, var(--pink), var(--orange));
  border-radius: 50%;
  display: flex; align-items: center; justify-content: center;
  font-size: 1.3rem; color: white;
  box-shadow: 0 4px 0 rgba(255,110,180,0.3);
  transition: all 0.15s;
  z-index: 1;
}
.yt-placeholder:hover .play-btn { transform: scale(1.1); filter: brightness(1.08); }
.yt-placeholder span { z-index: 1; color: var(--purple); }

/* â”€â”€ RIGHT PANEL â”€â”€ */
.right-panel {
  width: 190px;
  flex-shrink: 0;
  background: white;
  display: flex;
  flex-direction: column;
  padding: 0.8rem 0.7rem;
  gap: 0.7rem;
  overflow-y: auto;
  border-left: 4px solid #ffe0f0;
  box-shadow: -4px 0 12px rgba(255,110,180,0.07);
}
.right-panel::-webkit-scrollbar { width: 5px; }
.right-panel::-webkit-scrollbar-thumb { background: #ffc0e0; border-radius: 10px; }

.rp-title {
  font-size: 0.68rem;
  font-weight: 800;
  letter-spacing: 0.1em;
  text-transform: uppercase;
  color: white;
  background: linear-gradient(135deg, var(--purple), var(--blue));
  border-radius: 12px;
  padding: 0.25rem 0.6rem;
  text-align: center;
}
.rp-char-big {
  font-family: 'Noto Serif SC', serif;
  font-size: 3.8rem;
  text-align: center;
  line-height: 1;
  background: linear-gradient(135deg, #fff0f8, #f0f8ff);
  border-radius: 16px;
  padding: 0.4rem;
  border: 3px solid #ffe0f0;
}
.rp-row {
  display: flex; justify-content: space-between; align-items: center;
  background: #f8f0ff;
  border-radius: 10px;
  padding: 0.2rem 0.5rem;
}
.rp-key { font-size: 0.68rem; font-weight: 700; color: #a0a0c0; }
.rp-val { font-size: 0.8rem; font-weight: 800; color: var(--ink); }
.rp-val.red { color: var(--pink); }

.mastery-bar-wrap { background: #f8f0ff; border-radius: 12px; padding: 0.4rem 0.5rem; }
.mastery-label { display: flex; justify-content: space-between; font-size: 0.68rem; font-weight: 700; color: #a0a0c0; margin-bottom: 0.3rem; }
.mastery-bar { height: 8px; background: #e8d5ff; border-radius: 10px; overflow: hidden; }
.mastery-fill { height: 100%; background: linear-gradient(90deg, var(--pink), var(--orange)); border-radius: 10px; transition: width 0.4s; }

.mark-btns { display: flex; flex-direction: column; gap: 0.4rem; }
.mark-btns button {
  font-family: 'Nunito', sans-serif;
  font-size: 0.78rem;
  font-weight: 800;
  padding: 0.4rem 0.5rem;
  border-radius: 14px;
  border: 3px solid transparent;
  cursor: pointer;
  transition: all 0.15s;
  box-shadow: 0 3px 0 rgba(0,0,0,0.08);
  background: #f8f0ff;
  color: var(--ink);
}
.mark-btns button:hover { transform: translateY(-1px); }
.mark-btns button:active { transform: translateY(2px); box-shadow: none; }
.mark-btns .mbad { background: #fff0f0; border-color: #ffcdd2; color: var(--red); }
.mark-btns .mbad:hover { background: var(--red); color: white; }
.mark-btns .mgood { background: #f0fff4; border-color: #c8e6c9; color: var(--green); }
.mark-btns .mgood:hover { background: var(--green); color: white; }

.session-box {
  background: linear-gradient(135deg, #fff9c4, #fff0f8);
  border-radius: 14px;
  padding: 0.5rem 0.6rem;
  border: 3px solid #ffe082;
  margin-top: auto;
}

/* â”€â”€ CAT TABS â”€â”€ */
.cat-tabs {
  display: flex; flex-wrap: wrap; gap: 0.3rem; padding: 0.5rem;
  border-bottom: 3px solid #ffe0f0;
  background: #fff5fb;
  flex-shrink: 0;
}
.cat-tab {
  font-family: 'Nunito', sans-serif;
  font-size: 0.72rem; font-weight: 700;
  padding: 0.2rem 0.6rem;
  border: 2px solid #ffc0e0; border-radius: 20px;
  cursor: pointer; background: white;
  transition: all 0.15s;
  white-space: nowrap;
}
.cat-tab:hover { border-color: var(--pink); color: var(--pink); }
.cat-tab.active { background: linear-gradient(135deg, var(--pink), var(--orange)); color: white; border-color: transparent; }

/* â”€â”€ RESPONSIVE â”€â”€ */
@media (max-width: 700px) {
  .sidebar { width: 130px; }
  .right-panel { display: none; }
  .ref-char { width: 120px; height: 120px; font-size: 82px; }
  .cpill { width: 32px; height: 32px; font-size: 0.95rem; border-radius: 8px; }
}
@media (max-width: 500px) {
  .sidebar { display: none; }
}
</style>
</head>
<body>

<!-- TOP BAR -->
<div class="topbar">
  <h1><span class="emoji">ğŸ¼</span> å°ç†Š <span>å­¦æ±‰å­—</span></h1>
  <div class="topbar-controls">
    <select id="levelSelect">
      <option value="top100" selected>â­ Top 100 Most Common</option>
      <option value="hsk1">ğŸ“— HSK 1</option>
      <option value="hsk2">ğŸ“˜ HSK 2</option>
      <option value="hsk3">ğŸ“™ HSK 3</option>
      <option value="radicals">ğŸ”‘ Radicals</option>
      <option value="numbers">ğŸ”¢ Numbers</option>
      <option value="greetings">ğŸ‘‹ Greetings</option>
      <option value="family">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ Family</option>
      <option value="nature">ğŸŒ¿ Nature</option>
      <option value="body">ğŸ«€ Body</option>
      <option value="food">ğŸœ Food</option>
      <option value="time">â° Time</option>
      <option value="colors">ğŸ¨ Colors</option>
      <option value="animals">ğŸ¼ Animals</option>
      <option value="verbs">ğŸƒ Verbs</option>
      <option value="adjectives">ğŸ’« Adjectives</option>
    </select>
    <label class="brush-wrap">âœï¸ <input type="range" id="brushSize" min="3" max="28" value="10"> <span id="brushVal">10</span></label>
    <button class="btn" id="ghostBtn">ğŸ‘» Ghost</button>
    <button class="btn" id="gridBtn">âŠ Grid</button>
    <button class="btn red" id="clearBtn">ğŸ—‘ Clear</button>
    <button class="btn" id="undoBtn">â†©</button>
    <span class="progress-txt" id="progressTxt"></span>
  </div>
</div>

<!-- APP -->
<div class="app">
  <!-- SIDEBAR -->
  <div class="sidebar">
    <div class="sidebar-header">âœ¨ Characters âœ¨</div>
    <div class="sidebar-search">
      <input type="text" id="searchInput" placeholder="ğŸ” Searchâ€¦">
    </div>
    <div class="cat-tabs" id="catTabs" style="display:none"></div>
    <div class="char-grid" id="charGrid"></div>
  </div>

  <!-- CENTER -->
  <div class="center">
    <div class="practice-row">
      <!-- Reference -->
      <div class="ref-box">
        <span class="ref-label">ğŸ“– Look Here!</span>
        <div class="ref-char" id="refChar">ä¸€</div>
        <div class="ref-info">
          <div class="ref-pinyin" id="refPinyin">yÄ«</div>
          <div class="ref-meaning" id="refMeaning">one / the number 1</div>
        </div>
        <div class="ref-nav">
          <button id="prevBtn">â—€ Back</button>
          <button id="randBtn">ğŸ² Random</button>
          <button id="nextBtn">Next â–¶</button>
        </div>
      </div>

      <!-- Canvas -->
      <div class="canvas-box">
        <span class="canvas-label">âœï¸ Write Here!</span>
        <div class="canvas-wrap" id="canvasWrap">
          <svg class="grid-overlay" id="gridSvg"></svg>
          <div class="ghost" id="ghostEl"></div>
          <canvas id="drawCanvas"></canvas>
        </div>

        <!-- YouTube Video Panel -->
        <div class="yt-panel" id="ytPanel">
          <div class="yt-header">
            <div class="yt-header-left">
              <span class="yt-logo">â–¶</span>
              <span>Watch:</span>
              <span class="yt-char-label" id="ytCharLabel">ä¸€</span>
            </div>
            <div class="yt-links">
              <a class="yt-link active-link" id="ytLink1" href="#" target="_blank">âœ Strokes</a>
              <a class="yt-link" id="ytLink2" href="#" target="_blank">ğŸ”¤ Sound</a>
              <a class="yt-link" id="ytLink3" href="#" target="_blank">â†— YouTube</a>
            </div>
          </div>
          <div class="yt-embed-wrap" id="ytEmbedWrap">
            <div class="yt-placeholder" id="ytPlaceholder">
              <div class="yt-placeholder-char" id="ytPlaceholderChar">ä¸€</div>
              <div class="play-btn">â–¶</div>
              <span id="ytPlaceholderText">Click to search stroke order video</span>
            </div>
          </div>
        </div>

        <div class="canvas-btns">
          <button id="undoBtn2">â†© Undo</button>
          <button id="clearBtn2">ğŸ—‘ Clear</button>
          <button id="nextCharBtn">Next â–¶</button>
        </div>
      </div>
    </div>
  </div>

  <!-- RIGHT PANEL -->
  <div class="right-panel">
    <div class="rp-title">ğŸ” Character Info</div>
    <div class="rp-char-big" id="rpChar">ä¸€</div>
    <div class="rp-row"><span class="rp-key">Pinyin</span><span class="rp-val red" id="rpPinyin">yÄ«</span></div>
    <div class="rp-row"><span class="rp-key">Strokes</span><span class="rp-val" id="rpStrokes">1</span></div>
    <div class="rp-row"><span class="rp-key">Radical</span><span class="rp-val" id="rpRadical">ä¸€</span></div>
    <div class="rp-row"><span class="rp-key">HSK</span><span class="rp-val" id="rpHSK">1</span></div>
    <div class="rp-key" style="font-size:0.68rem;font-weight:700;color:#a0a0c0;padding: 0 0.2rem;">Meaning</div>
    <div style="font-size:0.82rem;font-weight:700;line-height:1.4;background:#f8f0ff;border-radius:10px;padding:0.3rem 0.5rem;color:var(--ink)" id="rpMeaning">one / the number 1</div>

    <div class="mastery-bar-wrap">
      <div class="mastery-label"><span>â­ Mastery</span><span id="masteryPct">0%</span></div>
      <div class="mastery-bar"><div class="mastery-fill" id="masteryFill" style="width:0%"></div></div>
    </div>

    <div class="rp-title">ğŸ… Mark Practice</div>
    <div class="mark-btns">
      <button class="mbad" onclick="markChar(1)">ğŸ˜• Need More!</button>
      <button onclick="markChar(2)">ğŸ™‚ Getting it!</button>
      <button class="mgood" onclick="markChar(3)">â­ I got it!</button>
    </div>

    <div class="session-box">
      <div class="rp-title" style="margin-bottom:0.4rem">ğŸ¯ Today</div>
      <div class="rp-row" style="margin-top:0.3rem"><span class="rp-key">Practiced</span><span class="rp-val" id="sessionCount">0</span></div>
      <div class="rp-row" style="margin-top:0.3rem"><span class="rp-key">Mastered</span><span class="rp-val" id="masteredCount">0</span></div>
    </div>
  </div>
</div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  CHARACTER DATABASE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const DB = {
  numbers: [
    {char:'é›¶',pinyin:'lÃ­ng',meaning:'zero',strokes:13,radical:'é›¨',hsk:1},
    {char:'ä¸€',pinyin:'yÄ«',meaning:'one',strokes:1,radical:'ä¸€',hsk:1},
    {char:'äºŒ',pinyin:'Ã¨r',meaning:'two',strokes:2,radical:'äºŒ',hsk:1},
    {char:'ä¸‰',pinyin:'sÄn',meaning:'three',strokes:3,radical:'ä¸€',hsk:1},
    {char:'å››',pinyin:'sÃ¬',meaning:'four',strokes:5,radical:'å›—',hsk:1},
    {char:'äº”',pinyin:'wÇ”',meaning:'five',strokes:4,radical:'äºŒ',hsk:1},
    {char:'å…­',pinyin:'liÃ¹',meaning:'six',strokes:4,radical:'å…«',hsk:1},
    {char:'ä¸ƒ',pinyin:'qÄ«',meaning:'seven',strokes:2,radical:'ä¸€',hsk:1},
    {char:'å…«',pinyin:'bÄ',meaning:'eight',strokes:2,radical:'å…«',hsk:1},
    {char:'ä¹',pinyin:'jiÇ”',meaning:'nine',strokes:2,radical:'ä¹™',hsk:1},
    {char:'å',pinyin:'shÃ­',meaning:'ten',strokes:2,radical:'å',hsk:1},
    {char:'ç™¾',pinyin:'bÇi',meaning:'hundred',strokes:6,radical:'ç™½',hsk:1},
    {char:'åƒ',pinyin:'qiÄn',meaning:'thousand',strokes:3,radical:'å',hsk:1},
    {char:'ä¸‡',pinyin:'wÃ n',meaning:'ten thousand',strokes:3,radical:'ä¸€',hsk:1},
    {char:'äº¿',pinyin:'yÃ¬',meaning:'100 million',strokes:3,radical:'äº»',hsk:2},
  ],
  greetings: [
    {char:'ä½ ',pinyin:'nÇ',meaning:'you',strokes:7,radical:'äº»',hsk:1},
    {char:'å¥½',pinyin:'hÇo',meaning:'good/well',strokes:6,radical:'å¥³',hsk:1},
    {char:'æˆ‘',pinyin:'wÇ’',meaning:'I/me',strokes:7,radical:'æˆˆ',hsk:1},
    {char:'æ˜¯',pinyin:'shÃ¬',meaning:'to be/is',strokes:9,radical:'æ—¥',hsk:1},
    {char:'ä¸',pinyin:'bÃ¹',meaning:'no/not',strokes:4,radical:'ä¸€',hsk:1},
    {char:'è°¢',pinyin:'xiÃ¨',meaning:'to thank',strokes:12,radical:'è® ',hsk:1},
    {char:'å†',pinyin:'zÃ i',meaning:'again',strokes:6,radical:'å†‚',hsk:1},
    {char:'è§',pinyin:'jiÃ n',meaning:'to see/meet',strokes:4,radical:'è§',hsk:1},
    {char:'è¯·',pinyin:'qÇng',meaning:'please/invite',strokes:10,radical:'è® ',hsk:1},
    {char:'é—®',pinyin:'wÃ¨n',meaning:'to ask',strokes:6,radical:'å£',hsk:1},
    {char:'å',pinyin:'mÃ­ng',meaning:'name',strokes:6,radical:'å¤•',hsk:1},
    {char:'å­—',pinyin:'zÃ¬',meaning:'character/word',strokes:6,radical:'å®€',hsk:1},
    {char:'å«',pinyin:'jiÃ o',meaning:'to be called',strokes:5,radical:'å£',hsk:1},
    {char:'å¯¹',pinyin:'duÃ¬',meaning:'correct/towards',strokes:5,radical:'åˆ',hsk:1},
    {char:'å“¦',pinyin:'Ã³',meaning:'oh! (exclamation)',strokes:9,radical:'å£',hsk:1},
    {char:'å—',pinyin:'ma',meaning:'question particle',strokes:6,radical:'å£',hsk:1},
    {char:'å‘¢',pinyin:'ne',meaning:'(question particle)',strokes:8,radical:'å£',hsk:1},
    {char:'å•Š',pinyin:'a',meaning:'(exclamation)',strokes:10,radical:'å£',hsk:1},
  ],
  family: [
    {char:'å®¶',pinyin:'jiÄ',meaning:'home/family',strokes:10,radical:'å®€',hsk:1},
    {char:'äºº',pinyin:'rÃ©n',meaning:'person/people',strokes:2,radical:'äºº',hsk:1},
    {char:'çˆ¶',pinyin:'fÃ¹',meaning:'father',strokes:4,radical:'çˆ¶',hsk:2},
    {char:'æ¯',pinyin:'mÇ”',meaning:'mother',strokes:5,radical:'æ¯',hsk:2},
    {char:'çˆ¸',pinyin:'bÃ ',meaning:'dad',strokes:8,radical:'çˆ¶',hsk:1},
    {char:'å¦ˆ',pinyin:'mÄ',meaning:'mom',strokes:6,radical:'å¥³',hsk:1},
    {char:'å­',pinyin:'zÇ',meaning:'son/child',strokes:3,radical:'å­',hsk:1},
    {char:'å¥³',pinyin:'nÇš',meaning:'female/daughter',strokes:3,radical:'å¥³',hsk:1},
    {char:'å…„',pinyin:'xiÅng',meaning:'elder brother',strokes:5,radical:'å„¿',hsk:2},
    {char:'å¼Ÿ',pinyin:'dÃ¬',meaning:'younger brother',strokes:7,radical:'å¼“',hsk:1},
    {char:'å§',pinyin:'jiÄ›',meaning:'elder sister',strokes:8,radical:'å¥³',hsk:1},
    {char:'å¦¹',pinyin:'mÃ¨i',meaning:'younger sister',strokes:8,radical:'å¥³',hsk:1},
    {char:'å“¥',pinyin:'gÄ“',meaning:'older brother',strokes:10,radical:'å£',hsk:1},
    {char:'ä¸ˆ',pinyin:'zhÃ ng',meaning:'husband (formal)',strokes:3,radical:'ä¸€',hsk:2},
    {char:'å¤«',pinyin:'fÅ«',meaning:'husband',strokes:4,radical:'å¤§',hsk:2},
    {char:'å¦»',pinyin:'qÄ«',meaning:'wife',strokes:8,radical:'å¥³',hsk:2},
    {char:'å­©',pinyin:'hÃ¡i',meaning:'child',strokes:9,radical:'å­',hsk:1},
    {char:'å„¿',pinyin:'Ã©r',meaning:'son/child',strokes:2,radical:'å„¿',hsk:1},
    {char:'ç¥–',pinyin:'zÇ”',meaning:'ancestor/grandfather',strokes:9,radical:'ç¤»',hsk:3},
    {char:'å­™',pinyin:'sÅ«n',meaning:'grandchild',strokes:6,radical:'å­',hsk:3},
  ],
  nature: [
    {char:'å±±',pinyin:'shÄn',meaning:'mountain',strokes:3,radical:'å±±',hsk:1},
    {char:'æ°´',pinyin:'shuÇ',meaning:'water',strokes:4,radical:'æ°´',hsk:1},
    {char:'ç«',pinyin:'huÇ’',meaning:'fire',strokes:4,radical:'ç«',hsk:1},
    {char:'æœ¨',pinyin:'mÃ¹',meaning:'wood/tree',strokes:4,radical:'æœ¨',hsk:1},
    {char:'åœŸ',pinyin:'tÇ”',meaning:'earth/soil',strokes:3,radical:'åœŸ',hsk:1},
    {char:'æ—¥',pinyin:'rÃ¬',meaning:'sun/day',strokes:4,radical:'æ—¥',hsk:1},
    {char:'æœˆ',pinyin:'yuÃ¨',meaning:'moon/month',strokes:4,radical:'æœˆ',hsk:1},
    {char:'å¤©',pinyin:'tiÄn',meaning:'sky/heaven/day',strokes:4,radical:'å¤§',hsk:1},
    {char:'åœ°',pinyin:'dÃ¬',meaning:'earth/ground',strokes:6,radical:'åœŸ',hsk:1},
    {char:'é£',pinyin:'fÄ“ng',meaning:'wind',strokes:4,radical:'é£',hsk:1},
    {char:'é›¨',pinyin:'yÇ”',meaning:'rain',strokes:8,radical:'é›¨',hsk:1},
    {char:'é›ª',pinyin:'xuÄ›',meaning:'snow',strokes:11,radical:'é›¨',hsk:1},
    {char:'äº‘',pinyin:'yÃºn',meaning:'cloud',strokes:4,radical:'äºŒ',hsk:2},
    {char:'èŠ±',pinyin:'huÄ',meaning:'flower',strokes:7,radical:'è‰¹',hsk:1},
    {char:'è‰',pinyin:'cÇo',meaning:'grass/plant',strokes:9,radical:'è‰¹',hsk:1},
    {char:'æ ‘',pinyin:'shÃ¹',meaning:'tree',strokes:9,radical:'æœ¨',hsk:1},
    {char:'æ²³',pinyin:'hÃ©',meaning:'river',strokes:8,radical:'æ°µ',hsk:2},
    {char:'æµ·',pinyin:'hÇi',meaning:'sea/ocean',strokes:10,radical:'æ°µ',hsk:1},
    {char:'çŸ³',pinyin:'shÃ­',meaning:'stone/rock',strokes:5,radical:'çŸ³',hsk:2},
    {char:'æ²™',pinyin:'shÄ',meaning:'sand',strokes:7,radical:'æ°µ',hsk:2},
  ],
  body: [
    {char:'æ‰‹',pinyin:'shÇ’u',meaning:'hand',strokes:4,radical:'æ‰‹',hsk:1},
    {char:'å£',pinyin:'kÇ’u',meaning:'mouth',strokes:3,radical:'å£',hsk:1},
    {char:'è€³',pinyin:'Ä›r',meaning:'ear',strokes:6,radical:'è€³',hsk:1},
    {char:'ç›®',pinyin:'mÃ¹',meaning:'eye (formal)',strokes:5,radical:'ç›®',hsk:2},
    {char:'çœ¼',pinyin:'yÇn',meaning:'eye',strokes:11,radical:'ç›®',hsk:1},
    {char:'é¼»',pinyin:'bÃ­',meaning:'nose',strokes:14,radical:'é¼»',hsk:1},
    {char:'è„¸',pinyin:'liÇn',meaning:'face',strokes:11,radical:'æœˆ',hsk:1},
    {char:'å¤´',pinyin:'tÃ³u',meaning:'head',strokes:5,radical:'å¤§',hsk:1},
    {char:'å‘',pinyin:'fÃ ',meaning:'hair',strokes:5,radical:'åˆ',hsk:1},
    {char:'å¿ƒ',pinyin:'xÄ«n',meaning:'heart/mind',strokes:4,radical:'å¿ƒ',hsk:1},
    {char:'è‚š',pinyin:'dÃ¹',meaning:'belly/stomach',strokes:7,radical:'æœˆ',hsk:2},
    {char:'èƒŒ',pinyin:'bÃ¨i',meaning:'back (body)',strokes:9,radical:'æœˆ',hsk:2},
    {char:'è…¿',pinyin:'tuÇ',meaning:'leg',strokes:13,radical:'æœˆ',hsk:1},
    {char:'è„š',pinyin:'jiÇo',meaning:'foot',strokes:11,radical:'æœˆ',hsk:1},
    {char:'è‡‚',pinyin:'bÃ¬',meaning:'arm',strokes:13,radical:'æœˆ',hsk:3},
    {char:'æŒ‡',pinyin:'zhÇ',meaning:'finger/point',strokes:9,radical:'æ‰‹',hsk:2},
    {char:'éª¨',pinyin:'gÇ”',meaning:'bone',strokes:9,radical:'éª¨',hsk:3},
    {char:'è¡€',pinyin:'xuÃ¨',meaning:'blood',strokes:6,radical:'è¡€',hsk:3},
  ],
  food: [
    {char:'é¥­',pinyin:'fÃ n',meaning:'rice/meal',strokes:7,radical:'é¥£',hsk:1},
    {char:'æ°´',pinyin:'shuÇ',meaning:'water',strokes:4,radical:'æ°´',hsk:1},
    {char:'èŒ¶',pinyin:'chÃ¡',meaning:'tea',strokes:9,radical:'è‰¹',hsk:1},
    {char:'é…’',pinyin:'jiÇ”',meaning:'alcohol/wine',strokes:10,radical:'æ°µ',hsk:2},
    {char:'è‚‰',pinyin:'rÃ²u',meaning:'meat',strokes:6,radical:'è‚‰',hsk:2},
    {char:'é±¼',pinyin:'yÃº',meaning:'fish',strokes:8,radical:'é±¼',hsk:1},
    {char:'è›‹',pinyin:'dÃ n',meaning:'egg',strokes:11,radical:'è™«',hsk:1},
    {char:'èœ',pinyin:'cÃ i',meaning:'vegetable/dish',strokes:11,radical:'è‰¹',hsk:1},
    {char:'ç±³',pinyin:'mÇ',meaning:'uncooked rice',strokes:6,radical:'ç±³',hsk:1},
    {char:'é¢',pinyin:'miÃ n',meaning:'noodles/flour/face',strokes:9,radical:'éº¦',hsk:1},
    {char:'ç³–',pinyin:'tÃ¡ng',meaning:'sugar/candy',strokes:16,radical:'ç±³',hsk:2},
    {char:'ç›',pinyin:'yÃ¡n',meaning:'salt',strokes:8,radical:'çš¿',hsk:3},
    {char:'è¾£',pinyin:'lÃ ',meaning:'spicy/hot',strokes:14,radical:'è¾›',hsk:2},
    {char:'ç”œ',pinyin:'tiÃ¡n',meaning:'sweet',strokes:11,radical:'èˆŒ',hsk:2},
    {char:'è‹¦',pinyin:'kÇ”',meaning:'bitter',strokes:8,radical:'è‰¹',hsk:2},
    {char:'é…¸',pinyin:'suÄn',meaning:'sour',strokes:14,radical:'é…‰',hsk:2},
    {char:'çƒ­',pinyin:'rÃ¨',meaning:'hot',strokes:10,radical:'ç¬',hsk:1},
    {char:'å†·',pinyin:'lÄ›ng',meaning:'cold',strokes:7,radical:'å†«',hsk:1},
    {char:'è‹¹',pinyin:'pÃ­ng',meaning:'apple (è‹¹æœ)',strokes:8,radical:'è‰¹',hsk:1},
    {char:'æœ',pinyin:'guÇ’',meaning:'fruit/result',strokes:8,radical:'æœ¨',hsk:1},
  ],
  time: [
    {char:'å¹´',pinyin:'niÃ¡n',meaning:'year',strokes:6,radical:'å¹²',hsk:1},
    {char:'æœˆ',pinyin:'yuÃ¨',meaning:'month/moon',strokes:4,radical:'æœˆ',hsk:1},
    {char:'æ—¥',pinyin:'rÃ¬',meaning:'day/sun',strokes:4,radical:'æ—¥',hsk:1},
    {char:'æ—¶',pinyin:'shÃ­',meaning:'time/hour',strokes:7,radical:'æ—¥',hsk:1},
    {char:'åˆ†',pinyin:'fÄ“n',meaning:'minute/part',strokes:4,radical:'åˆ€',hsk:1},
    {char:'ç§’',pinyin:'miÇo',meaning:'second',strokes:9,radical:'ç¦¾',hsk:2},
    {char:'ä»Š',pinyin:'jÄ«n',meaning:'now/today',strokes:4,radical:'äºº',hsk:1},
    {char:'æ˜',pinyin:'mÃ­ng',meaning:'bright/tomorrow',strokes:8,radical:'æ—¥',hsk:1},
    {char:'æ˜¨',pinyin:'zuÃ³',meaning:'yesterday',strokes:9,radical:'æ—¥',hsk:1},
    {char:'å‰',pinyin:'qiÃ¡n',meaning:'before/in front',strokes:9,radical:'åˆ€',hsk:1},
    {char:'å',pinyin:'hÃ²u',meaning:'after/behind',strokes:6,radical:'å£',hsk:1},
    {char:'æ—©',pinyin:'zÇo',meaning:'early/morning',strokes:6,radical:'æ—¥',hsk:1},
    {char:'æ™š',pinyin:'wÇn',meaning:'late/evening',strokes:11,radical:'æ—¥',hsk:1},
    {char:'å‘¨',pinyin:'zhÅu',meaning:'week/zhou',strokes:8,radical:'å£',hsk:1},
    {char:'æ˜Ÿ',pinyin:'xÄ«ng',meaning:'star',strokes:9,radical:'æ—¥',hsk:1},
    {char:'æœŸ',pinyin:'qÄ«',meaning:'period/expect',strokes:12,radical:'æœˆ',hsk:1},
    {char:'ä¸Š',pinyin:'shÃ ng',meaning:'up/above/last',strokes:3,radical:'ä¸€',hsk:1},
    {char:'ä¸‹',pinyin:'xiÃ ',meaning:'down/below/next',strokes:3,radical:'ä¸€',hsk:1},
  ],
  colors: [
    {char:'çº¢',pinyin:'hÃ³ng',meaning:'red',strokes:6,radical:'çºŸ',hsk:1},
    {char:'è“',pinyin:'lÃ¡n',meaning:'blue',strokes:13,radical:'è‰¹',hsk:1},
    {char:'ç»¿',pinyin:'lÇœ',meaning:'green',strokes:11,radical:'çºŸ',hsk:1},
    {char:'é»„',pinyin:'huÃ¡ng',meaning:'yellow',strokes:11,radical:'é»„',hsk:1},
    {char:'ç™½',pinyin:'bÃ¡i',meaning:'white',strokes:5,radical:'ç™½',hsk:1},
    {char:'é»‘',pinyin:'hÄ“i',meaning:'black',strokes:12,radical:'é»‘',hsk:1},
    {char:'ç´«',pinyin:'zÇ',meaning:'purple',strokes:12,radical:'ç³¸',hsk:2},
    {char:'æ©™',pinyin:'chÃ©ng',meaning:'orange',strokes:16,radical:'æœ¨',hsk:2},
    {char:'ç²‰',pinyin:'fÄ›n',meaning:'pink/powder',strokes:10,radical:'ç±³',hsk:2},
    {char:'ç°',pinyin:'huÄ«',meaning:'gray/ash',strokes:6,radical:'ç«',hsk:2},
    {char:'æ£•',pinyin:'zÅng',meaning:'brown',strokes:12,radical:'æœ¨',hsk:3},
    {char:'è‰²',pinyin:'sÃ¨',meaning:'color',strokes:6,radical:'è‰²',hsk:1},
  ],
  animals: [
    {char:'çŒ«',pinyin:'mÄo',meaning:'cat',strokes:11,radical:'çŠ­',hsk:1},
    {char:'ç‹—',pinyin:'gÇ’u',meaning:'dog',strokes:8,radical:'çŠ­',hsk:1},
    {char:'é¸Ÿ',pinyin:'niÇo',meaning:'bird',strokes:5,radical:'é¸Ÿ',hsk:1},
    {char:'é±¼',pinyin:'yÃº',meaning:'fish',strokes:8,radical:'é±¼',hsk:1},
    {char:'é©¬',pinyin:'mÇ',meaning:'horse',strokes:3,radical:'é©¬',hsk:1},
    {char:'ç‰›',pinyin:'niÃº',meaning:'cow/ox',strokes:4,radical:'ç‰›',hsk:1},
    {char:'ç¾Š',pinyin:'yÃ¡ng',meaning:'sheep/goat',strokes:6,radical:'ç¾Š',hsk:1},
    {char:'çŒª',pinyin:'zhÅ«',meaning:'pig',strokes:11,radical:'çŠ­',hsk:2},
    {char:'é¸¡',pinyin:'jÄ«',meaning:'chicken',strokes:7,radical:'é¸Ÿ',hsk:1},
    {char:'å…”',pinyin:'tÃ¹',meaning:'rabbit',strokes:8,radical:'å„¿',hsk:2},
    {char:'è›‡',pinyin:'shÃ©',meaning:'snake',strokes:11,radical:'è™«',hsk:2},
    {char:'é¾™',pinyin:'lÃ³ng',meaning:'dragon',strokes:5,radical:'é¾™',hsk:2},
    {char:'è™',pinyin:'hÇ”',meaning:'tiger',strokes:8,radical:'è™',hsk:2},
    {char:'ç†Š',pinyin:'xiÃ³ng',meaning:'bear',strokes:14,radical:'ç¬',hsk:2},
    {char:'ç‹',pinyin:'hÃº',meaning:'fox',strokes:8,radical:'çŠ­',hsk:3},
    {char:'ç‹¼',pinyin:'lÃ¡ng',meaning:'wolf',strokes:10,radical:'çŠ­',hsk:3},
    {char:'è±¡',pinyin:'xiÃ ng',meaning:'elephant',strokes:12,radical:'è±•',hsk:2},
    {char:'é¼ ',pinyin:'shÇ”',meaning:'rat/mouse',strokes:13,radical:'é¼ ',hsk:2},
  ],
  verbs: [
    {char:'åƒ',pinyin:'chÄ«',meaning:'to eat',strokes:6,radical:'å£',hsk:1},
    {char:'å–',pinyin:'hÄ“',meaning:'to drink',strokes:12,radical:'å£',hsk:1},
    {char:'è¯´',pinyin:'shuÅ',meaning:'to speak/say',strokes:9,radical:'è® ',hsk:1},
    {char:'å¬',pinyin:'tÄ«ng',meaning:'to listen',strokes:7,radical:'å£',hsk:1},
    {char:'çœ‹',pinyin:'kÃ n',meaning:'to look/watch',strokes:9,radical:'ç›®',hsk:1},
    {char:'å†™',pinyin:'xiÄ›',meaning:'to write',strokes:5,radical:'å†–',hsk:1},
    {char:'è¯»',pinyin:'dÃº',meaning:'to read',strokes:10,radical:'è® ',hsk:1},
    {char:'èµ°',pinyin:'zÇ’u',meaning:'to walk/go',strokes:7,radical:'èµ°',hsk:1},
    {char:'æ¥',pinyin:'lÃ¡i',meaning:'to come',strokes:7,radical:'æœ¨',hsk:1},
    {char:'å»',pinyin:'qÃ¹',meaning:'to go',strokes:5,radical:'å»',hsk:1},
    {char:'ä¹°',pinyin:'mÇi',meaning:'to buy',strokes:6,radical:'ä¹™',hsk:1},
    {char:'å–',pinyin:'mÃ i',meaning:'to sell',strokes:8,radical:'å£«',hsk:2},
    {char:'å­¦',pinyin:'xuÃ©',meaning:'to study/learn',strokes:8,radical:'å­',hsk:1},
    {char:'æ•™',pinyin:'jiÄo',meaning:'to teach',strokes:11,radical:'æ”´',hsk:2},
    {char:'åš',pinyin:'zuÃ²',meaning:'to do/make',strokes:11,radical:'äº»',hsk:1},
    {char:'æƒ³',pinyin:'xiÇng',meaning:'to think/want',strokes:13,radical:'å¿ƒ',hsk:1},
    {char:'çŸ¥',pinyin:'zhÄ«',meaning:'to know',strokes:8,radical:'çŸ¢',hsk:1},
    {char:'çˆ±',pinyin:'Ã i',meaning:'to love',strokes:10,radical:'çˆª',hsk:1},
    {char:'å¸®',pinyin:'bÄng',meaning:'to help',strokes:9,radical:'å·¾',hsk:2},
    {char:'æ‰“',pinyin:'dÇ',meaning:'to hit/play/call',strokes:5,radical:'æ‰‹',hsk:1},
  ],
  adjectives: [
    {char:'å¤§',pinyin:'dÃ ',meaning:'big/large',strokes:3,radical:'å¤§',hsk:1},
    {char:'å°',pinyin:'xiÇo',meaning:'small/little',strokes:3,radical:'å°',hsk:1},
    {char:'å¤š',pinyin:'duÅ',meaning:'many/much',strokes:6,radical:'å¤•',hsk:1},
    {char:'å°‘',pinyin:'shÇo',meaning:'few/little',strokes:4,radical:'å°',hsk:1},
    {char:'é•¿',pinyin:'chÃ¡ng',meaning:'long',strokes:4,radical:'é•¿',hsk:1},
    {char:'çŸ­',pinyin:'duÇn',meaning:'short',strokes:12,radical:'çŸ¢',hsk:1},
    {char:'é«˜',pinyin:'gÄo',meaning:'tall/high',strokes:10,radical:'é«˜',hsk:1},
    {char:'ä½',pinyin:'dÄ«',meaning:'low/short',strokes:7,radical:'äº»',hsk:2},
    {char:'å¿«',pinyin:'kuÃ i',meaning:'fast/quick',strokes:7,radical:'å¿„',hsk:1},
    {char:'æ…¢',pinyin:'mÃ n',meaning:'slow',strokes:14,radical:'å¿„',hsk:1},
    {char:'æ–°',pinyin:'xÄ«n',meaning:'new',strokes:13,radical:'æ–¤',hsk:1},
    {char:'æ—§',pinyin:'jiÃ¹',meaning:'old/used',strokes:5,radical:'æ—¥',hsk:2},
    {char:'ç¾',pinyin:'mÄ›i',meaning:'beautiful',strokes:9,radical:'ç¾Š',hsk:1},
    {char:'ä¸‘',pinyin:'chÇ’u',meaning:'ugly',strokes:4,radical:'ä¸€',hsk:3},
    {char:'è´µ',pinyin:'guÃ¬',meaning:'expensive',strokes:9,radical:'è´',hsk:1},
    {char:'ä¾¿',pinyin:'piÃ¡n',meaning:'cheap/convenient',strokes:9,radical:'äº»',hsk:2},
    {char:'éš¾',pinyin:'nÃ¡n',meaning:'difficult',strokes:10,radical:'åˆ',hsk:1},
    {char:'æ˜“',pinyin:'yÃ¬',meaning:'easy',strokes:8,radical:'æ—¥',hsk:2},
    {char:'å¿™',pinyin:'mÃ¡ng',meaning:'busy',strokes:6,radical:'å¿„',hsk:1},
    {char:'ç´¯',pinyin:'lÃ¨i',meaning:'tired',strokes:11,radical:'ç³¸',hsk:1},
  ],
  hsk1: [
    {char:'çˆ±',pinyin:'Ã i',meaning:'love',strokes:10,radical:'çˆª',hsk:1},
    {char:'å…«',pinyin:'bÄ',meaning:'eight',strokes:2,radical:'å…«',hsk:1},
    {char:'çˆ¸çˆ¸',pinyin:'bÃ  ba',meaning:'father/dad',strokes:8,radical:'çˆ¶',hsk:1},
    {char:'æ¯å­',pinyin:'bÄ“i zi',meaning:'cup/glass',strokes:8,radical:'æœ¨',hsk:1},
    {char:'åŒ—äº¬',pinyin:'BÄ›i jÄ«ng',meaning:'Beijing',strokes:5,radical:'åŒ•',hsk:1},
    {char:'æœ¬',pinyin:'bÄ›n',meaning:'book/root',strokes:5,radical:'æœ¨',hsk:1},
    {char:'ä¸',pinyin:'bÃ¹',meaning:'no/not',strokes:4,radical:'ä¸€',hsk:1},
    {char:'ä¸å®¢æ°”',pinyin:'bÃº kÃ¨ qi',meaning:"you're welcome",strokes:4,radical:'ä¸€',hsk:1},
    {char:'èœ',pinyin:'cÃ i',meaning:'dish/vegetable',strokes:11,radical:'è‰¹',hsk:1},
    {char:'èŒ¶',pinyin:'chÃ¡',meaning:'tea',strokes:9,radical:'è‰¹',hsk:1},
    {char:'åƒ',pinyin:'chÄ«',meaning:'eat',strokes:6,radical:'å£',hsk:1},
    {char:'å‡ºç§Ÿè½¦',pinyin:'chÅ« zÅ« chÄ“',meaning:'taxi',strokes:5,radical:'å‡µ',hsk:1},
    {char:'æ‰“ç”µè¯',pinyin:'dÇ diÃ n huÃ ',meaning:'make a call',strokes:5,radical:'æ‰‹',hsk:1},
    {char:'å¤§',pinyin:'dÃ ',meaning:'big',strokes:3,radical:'å¤§',hsk:1},
    {char:'çš„',pinyin:'de',meaning:'(possessive)',strokes:8,radical:'ç™½',hsk:1},
    {char:'ç‚¹',pinyin:'diÇn',meaning:'point, dot, oclock',strokes:9,radical:'ç¬',hsk:1},
    {char:'ç”µè„‘',pinyin:'diÃ n nÇo',meaning:'computer',strokes:5,radical:'ç”°',hsk:1},
    {char:'ç”µè§†',pinyin:'diÃ n shÃ¬',meaning:'television',strokes:5,radical:'ç”°',hsk:1},
    {char:'ç”µå½±',pinyin:'diÃ n yÇng',meaning:'movie',strokes:5,radical:'ç”°',hsk:1},
    {char:'ä¸œè¥¿',pinyin:'dÅng xi',meaning:'thing/stuff',strokes:5,radical:'æœ¨',hsk:1},
    {char:'éƒ½',pinyin:'dÅu',meaning:'all/both',strokes:10,radical:'é‚‘',hsk:1},
    {char:'è¯»',pinyin:'dÃº',meaning:'read',strokes:10,radical:'è® ',hsk:1},
    {char:'å¯¹ä¸èµ·',pinyin:'duÃ¬ bu qÇ',meaning:'sorry',strokes:5,radical:'åˆ',hsk:1},
    {char:'å¤š',pinyin:'duÅ',meaning:'many',strokes:6,radical:'å¤•',hsk:1},
    {char:'å¤šå°‘',pinyin:'duÅ shÇo',meaning:'how many/much',strokes:6,radical:'å¤•',hsk:1},
    {char:'å„¿å­',pinyin:'Ã©r zi',meaning:'son',strokes:2,radical:'å„¿',hsk:1},
    {char:'äºŒ',pinyin:'Ã¨r',meaning:'two',strokes:2,radical:'äºŒ',hsk:1},
    {char:'é¥­åº—',pinyin:'fÃ n diÃ n',meaning:'hotel/restaurant',strokes:7,radical:'é¥£',hsk:1},
    {char:'é£æœº',pinyin:'fÄ“i jÄ«',meaning:'airplane',strokes:3,radical:'é£',hsk:1},
    {char:'åˆ†é’Ÿ',pinyin:'fÄ“n zhÅng',meaning:'minute',strokes:4,radical:'åˆ€',hsk:1},
    {char:'é«˜å…´',pinyin:'gÄo xÃ¬ng',meaning:'happy',strokes:10,radical:'é«˜',hsk:1},
    {char:'ä¸ª',pinyin:'gÃ¨',meaning:'(measure word)',strokes:3,radical:'äºº',hsk:1},
    {char:'å·¥ä½œ',pinyin:'gÅng zuÃ²',meaning:'work/job',strokes:3,radical:'å·¥',hsk:1},
    {char:'ç‹—',pinyin:'gÇ’u',meaning:'dog',strokes:8,radical:'çŠ­',hsk:1},
    {char:'æ±‰è¯­',pinyin:'HÃ n yÇ”',meaning:'Chinese language',strokes:5,radical:'æ°µ',hsk:1},
    {char:'å¥½',pinyin:'hÇo',meaning:'good',strokes:6,radical:'å¥³',hsk:1},
    {char:'å¥½åƒ',pinyin:'hÇo chÄ«',meaning:'delicious',strokes:6,radical:'å¥³',hsk:1},
    {char:'å–',pinyin:'hÄ“',meaning:'drink',strokes:12,radical:'å£',hsk:1},
    {char:'å’Œ',pinyin:'hÃ©',meaning:'and/with',strokes:8,radical:'å£',hsk:1},
    {char:'å¾ˆ',pinyin:'hÄ›n',meaning:'very',strokes:9,radical:'å½³',hsk:1},
    {char:'åé¢',pinyin:'hÃ²u miÃ n',meaning:'behind/back',strokes:6,radical:'å£',hsk:1},
    {char:'å›',pinyin:'huÃ­',meaning:'return',strokes:6,radical:'å›—',hsk:1},
    {char:'ä¼š',pinyin:'huÃ¬',meaning:'can/will',strokes:6,radical:'äºº',hsk:1},
    {char:'å‡ ',pinyin:'jÇ',meaning:'how many/several',strokes:2,radical:'å‡ ',hsk:1},
    {char:'å®¶',pinyin:'jiÄ',meaning:'home/family',strokes:10,radical:'å®€',hsk:1},
    {char:'å«',pinyin:'jiÃ o',meaning:'be called',strokes:5,radical:'å£',hsk:1},
    {char:'ä»Šå¤©',pinyin:'jÄ«n tiÄn',meaning:'today',strokes:4,radical:'äºº',hsk:1},
    {char:'ä¹',pinyin:'jiÇ”',meaning:'nine',strokes:2,radical:'ä¹™',hsk:1},
    {char:'å¼€',pinyin:'kÄi',meaning:'open',strokes:4,radical:'å»¾',hsk:1},
    {char:'çœ‹',pinyin:'kÃ n',meaning:'look/see',strokes:9,radical:'ç›®',hsk:1},
    {char:'çœ‹è§',pinyin:'kÃ n jiÃ n',meaning:'see/notice',strokes:9,radical:'ç›®',hsk:1},
  ].filter((v,i,a)=>a.findIndex(x=>x.char===v.char)===i),
  hsk2: [
    {char:'å§',pinyin:'ba',meaning:'(suggestion particle)',strokes:7,radical:'å£',hsk:2},
    {char:'ç™½',pinyin:'bÃ¡i',meaning:'white',strokes:5,radical:'ç™½',hsk:2},
    {char:'ç™¾',pinyin:'bÇi',meaning:'hundred',strokes:6,radical:'ç™½',hsk:2},
    {char:'å¸®åŠ©',pinyin:'bÄng zhÃ¹',meaning:'help/assist',strokes:9,radical:'å·¾',hsk:2},
    {char:'æŠ¥çº¸',pinyin:'bÃ o zhÇ',meaning:'newspaper',strokes:7,radical:'æ‰Œ',hsk:2},
    {char:'æ¯”',pinyin:'bÇ',meaning:'compare',strokes:4,radical:'æ¯”',hsk:2},
    {char:'åˆ«',pinyin:'biÃ©',meaning:"don't",strokes:7,radical:'åˆ€',hsk:2},
    {char:'å®¾é¦†',pinyin:'bÄ«n guÇn',meaning:'hotel',strokes:10,radical:'å®€',hsk:2},
    {char:'é•¿',pinyin:'chÃ¡ng',meaning:'long',strokes:4,radical:'é•¿',hsk:2},
    {char:'å”±æ­Œ',pinyin:'chÃ ng gÄ“',meaning:'sing a song',strokes:11,radical:'å£',hsk:2},
    {char:'å‡º',pinyin:'chÅ«',meaning:'exit/go out',strokes:5,radical:'å‡µ',hsk:2},
    {char:'ç©¿',pinyin:'chuÄn',meaning:'wear',strokes:9,radical:'ç©´',hsk:2},
    {char:'æ¬¡',pinyin:'cÃ¬',meaning:'time(s)/occasion',strokes:6,radical:'æ¬ ',hsk:2},
    {char:'ä»',pinyin:'cÃ³ng',meaning:'from',strokes:4,radical:'äºº',hsk:2},
    {char:'é”™',pinyin:'cuÃ²',meaning:'wrong/mistake',strokes:13,radical:'é’…',hsk:2},
    {char:'æ‰“ç¯®çƒ',pinyin:'dÇ lÃ¡n qiÃº',meaning:'play basketball',strokes:5,radical:'æ‰‹',hsk:2},
    {char:'å¸¦',pinyin:'dÃ i',meaning:'bring/take',strokes:9,radical:'å·¾',hsk:2},
    {char:'ä½†æ˜¯',pinyin:'dÃ n shÃ¬',meaning:'but/however',strokes:7,radical:'äº»',hsk:2},
    {char:'åˆ°',pinyin:'dÃ o',meaning:'arrive/reach',strokes:8,radical:'åˆ€',hsk:2},
    {char:'åœ°æ–¹',pinyin:'dÃ¬ fÄng',meaning:'place',strokes:6,radical:'åœŸ',hsk:2},
    {char:'å¼Ÿå¼Ÿ',pinyin:'dÃ¬ di',meaning:'younger brother',strokes:7,radical:'å¼“',hsk:2},
    {char:'ç¬¬ä¸€',pinyin:'dÃ¬ yÄ«',meaning:'first',strokes:11,radical:'ç«¹',hsk:2},
    {char:'æ‡‚',pinyin:'dÇ’ng',meaning:'understand',strokes:15,radical:'å¿„',hsk:2},
    {char:'å¯¹',pinyin:'duÃ¬',meaning:'correct',strokes:5,radical:'åˆ',hsk:2},
    {char:'æˆ¿é—´',pinyin:'fÃ¡ng jiÄn',meaning:'room',strokes:8,radical:'æˆ·',hsk:2},
    {char:'éå¸¸',pinyin:'fÄ“i chÃ¡ng',meaning:'very/extremely',strokes:8,radical:'é',hsk:2},
    {char:'æœåŠ¡å‘˜',pinyin:'fÃº wÃ¹ yuÃ¡n',meaning:'waiter/staff',strokes:8,radical:'æœˆ',hsk:2},
    {char:'é«˜',pinyin:'gÄo',meaning:'tall/high',strokes:10,radical:'é«˜',hsk:2},
    {char:'å‘Šè¯‰',pinyin:'gÃ o su',meaning:'tell/inform',strokes:7,radical:'å£',hsk:2},
    {char:'å“¥å“¥',pinyin:'gÄ“ ge',meaning:'elder brother',strokes:10,radical:'å£',hsk:2},
  ].filter((v,i,a)=>a.findIndex(x=>x.char===v.char)===i),
  hsk3: [
    {char:'é˜¿å§¨',pinyin:'Ä yÃ­',meaning:'auntie',strokes:7,radical:'é˜',hsk:3},
    {char:'å•Š',pinyin:'a',meaning:'(exclamation)',strokes:10,radical:'å£',hsk:3},
    {char:'çŸ®',pinyin:'Çi',meaning:'short (height)',strokes:13,radical:'çŸ¢',hsk:3},
    {char:'å®‰é™',pinyin:'Än jÃ¬ng',meaning:'quiet',strokes:6,radical:'å®€',hsk:3},
    {char:'æŠŠ',pinyin:'bÇ',meaning:'(disposal marker)',strokes:7,radical:'æ‰‹',hsk:3},
    {char:'ç­',pinyin:'bÄn',meaning:'class/shift',strokes:10,radical:'ç¨',hsk:3},
    {char:'æ¬',pinyin:'bÄn',meaning:'move/carry',strokes:13,radical:'æ‰‹',hsk:3},
    {char:'åŠ',pinyin:'bÃ n',meaning:'half',strokes:5,radical:'å',hsk:3},
    {char:'åŠæ³•',pinyin:'bÃ n fÇ',meaning:'method/way',strokes:4,radical:'åŠ›',hsk:3},
    {char:'åŠå…¬å®¤',pinyin:'bÃ n gÅng shÃ¬',meaning:'office',strokes:4,radical:'åŠ›',hsk:3},
    {char:'åŒ…',pinyin:'bÄo',meaning:'bag/wrap',strokes:5,radical:'å‹¹',hsk:3},
    {char:'é¥±',pinyin:'bÇo',meaning:'full (after eating)',strokes:8,radical:'é¥£',hsk:3},
    {char:'åŒ—æ–¹',pinyin:'bÄ›i fÄng',meaning:'north/northern',strokes:5,radical:'åŒ•',hsk:3},
    {char:'è¢«',pinyin:'bÃ¨i',meaning:'(passive marker)',strokes:10,radical:'è¡£',hsk:3},
    {char:'é¼»å­',pinyin:'bÃ­ zi',meaning:'nose',strokes:14,radical:'é¼»',hsk:3},
    {char:'æ¯”è¾ƒ',pinyin:'bÇ jiÃ o',meaning:'relatively/compare',strokes:4,radical:'æ¯”',hsk:3},
    {char:'ç¬”è®°æœ¬',pinyin:'bÇ jÃ¬ bÄ›n',meaning:'notebook',strokes:10,radical:'ç«¹',hsk:3},
    {char:'å¿…é¡»',pinyin:'bÃ¬ xÅ«',meaning:'must/have to',strokes:5,radical:'å¿ƒ',hsk:3},
    {char:'å˜åŒ–',pinyin:'biÃ n huÃ ',meaning:'change',strokes:8,radical:'åˆ',hsk:3},
    {char:'è¡¨ç¤º',pinyin:'biÇo shÃ¬',meaning:'express/indicate',strokes:8,radical:'è¡£',hsk:3},
    {char:'å†°ç®±',pinyin:'bÄ«ng xiÄng',meaning:'refrigerator',strokes:6,radical:'å†«',hsk:3},
    {char:'ä¸ä½†',pinyin:'bÃº dÃ n',meaning:'not only',strokes:4,radical:'ä¸€',hsk:3},
    {char:'éƒ¨åˆ†',pinyin:'bÃ¹ fen',meaning:'part/section',strokes:10,radical:'é‚‘',hsk:3},
    {char:'æ“¦',pinyin:'cÄ',meaning:'wipe/rub',strokes:17,radical:'æ‰‹',hsk:3},
    {char:'çŒœ',pinyin:'cÄi',meaning:'guess',strokes:11,radical:'çŠ­',hsk:3},
    {char:'å‚åŠ ',pinyin:'cÄn jiÄ',meaning:'participate/join',strokes:8,radical:'å¶',hsk:3},
    {char:'è‰',pinyin:'cÇo',meaning:'grass',strokes:9,radical:'è‰¹',hsk:3},
    {char:'å±‚',pinyin:'cÃ©ng',meaning:'layer/floor',strokes:7,radical:'å°¸',hsk:3},
    {char:'å·®',pinyin:'chÃ ',meaning:'differ/poor',strokes:9,radical:'å·¥',hsk:3},
    {char:'è¶…å¸‚',pinyin:'chÄo shÃ¬',meaning:'supermarket',strokes:12,radical:'èµ°',hsk:3},
  ].filter((v,i,a)=>a.findIndex(x=>x.char===v.char)===i),
  top100: [
    {char:'çš„',pinyin:'de',meaning:'of, possessive particle',strokes:8,radical:'ç™½',hsk:1},
    {char:'ä¸€',pinyin:'yÄ«',meaning:'one',strokes:1,radical:'ä¸€',hsk:1},
    {char:'æ˜¯',pinyin:'shÃ¬',meaning:'to be, yes',strokes:9,radical:'æ—¥',hsk:1},
    {char:'åœ¨',pinyin:'zÃ i',meaning:'at, in, on',strokes:6,radical:'åœŸ',hsk:1},
    {char:'ä¸',pinyin:'bÃ¹',meaning:'not, no',strokes:4,radical:'ä¸€',hsk:1},
    {char:'äº†',pinyin:'le',meaning:'completion particle',strokes:2,radical:'ä¹™',hsk:1},
    {char:'æœ‰',pinyin:'yÇ’u',meaning:'to have, there is',strokes:6,radical:'æœˆ',hsk:1},
    {char:'å’Œ',pinyin:'hÃ©',meaning:'and, with',strokes:8,radical:'å£',hsk:1},
    {char:'äºº',pinyin:'rÃ©n',meaning:'person, people',strokes:2,radical:'äºº',hsk:1},
    {char:'è¿™',pinyin:'zhÃ¨',meaning:'this',strokes:7,radical:'è¾¶',hsk:1},
    {char:'ä¸­',pinyin:'zhÅng',meaning:'middle, center, China',strokes:4,radical:'ä¸¨',hsk:1},
    {char:'å¤§',pinyin:'dÃ ',meaning:'big, large',strokes:3,radical:'å¤§',hsk:1},
    {char:'ä¸º',pinyin:'wÃ©i',meaning:'for, as, to be',strokes:4,radical:'ä¸¶',hsk:1},
    {char:'ä¸Š',pinyin:'shÃ ng',meaning:'up, above, on',strokes:3,radical:'ä¸€',hsk:1},
    {char:'ä¸ª',pinyin:'gÃ¨',meaning:'measure word',strokes:3,radical:'äºº',hsk:1},
    {char:'å›½',pinyin:'guÃ³',meaning:'country, nation',strokes:8,radical:'å›—',hsk:1},
    {char:'æˆ‘',pinyin:'wÇ’',meaning:'I, me',strokes:7,radical:'æˆˆ',hsk:1},
    {char:'ä»¥',pinyin:'yÇ',meaning:'with, by means of',strokes:4,radical:'äºº',hsk:2},
    {char:'è¦',pinyin:'yÃ o',meaning:'to want, need, must',strokes:9,radical:'è¦€',hsk:1},
    {char:'ä»–',pinyin:'tÄ',meaning:'he, him',strokes:5,radical:'äº»',hsk:1},
    {char:'æ—¶',pinyin:'shÃ­',meaning:'time, when',strokes:7,radical:'æ—¥',hsk:1},
    {char:'æ¥',pinyin:'lÃ¡i',meaning:'to come',strokes:7,radical:'æœ¨',hsk:1},
    {char:'ç”¨',pinyin:'yÃ²ng',meaning:'to use',strokes:5,radical:'ç”¨',hsk:1},
    {char:'ä»¬',pinyin:'men',meaning:'plural marker',strokes:5,radical:'äº»',hsk:1},
    {char:'ç”Ÿ',pinyin:'shÄ“ng',meaning:'to be born, life',strokes:5,radical:'ç”Ÿ',hsk:1},
    {char:'åˆ°',pinyin:'dÃ o',meaning:'to arrive, to',strokes:8,radical:'åˆ€',hsk:1},
    {char:'ä½œ',pinyin:'zuÃ²',meaning:'to make, work',strokes:7,radical:'äº»',hsk:2},
    {char:'åœ°',pinyin:'dÃ¬',meaning:'earth, ground',strokes:6,radical:'åœŸ',hsk:1},
    {char:'äº',pinyin:'yÃº',meaning:'at, in, on',strokes:3,radical:'äºŒ',hsk:3},
    {char:'å‡º',pinyin:'chÅ«',meaning:'to go out, exit',strokes:5,radical:'å‡µ',hsk:1},
    {char:'å°±',pinyin:'jiÃ¹',meaning:'then, just, immediately',strokes:12,radical:'äº¬',hsk:1},
    {char:'åˆ†',pinyin:'fÄ“n',meaning:'to divide, minute',strokes:4,radical:'åˆ€',hsk:1},
    {char:'å¯¹',pinyin:'duÃ¬',meaning:'correct, pair',strokes:5,radical:'åˆ',hsk:1},
    {char:'æˆ',pinyin:'chÃ©ng',meaning:'to become, succeed',strokes:6,radical:'æˆˆ',hsk:2},
    {char:'ä¼š',pinyin:'huÃ¬',meaning:'can, will, meeting',strokes:6,radical:'äºº',hsk:1},
    {char:'å¯',pinyin:'kÄ›',meaning:'can, may',strokes:5,radical:'å£',hsk:1},
    {char:'ä¸»',pinyin:'zhÇ”',meaning:'main, master',strokes:5,radical:'ä¸¶',hsk:2},
    {char:'å‘',pinyin:'fÄ',meaning:'to send, hair',strokes:5,radical:'åˆ',hsk:1},
    {char:'å¹´',pinyin:'niÃ¡n',meaning:'year',strokes:6,radical:'å¹²',hsk:1},
    {char:'åŠ¨',pinyin:'dÃ²ng',meaning:'to move, action',strokes:6,radical:'åŠ›',hsk:1},
    {char:'åŒ',pinyin:'tÃ³ng',meaning:'same, together',strokes:6,radical:'å£',hsk:2},
    {char:'å·¥',pinyin:'gÅng',meaning:'work, worker',strokes:3,radical:'å·¥',hsk:1},
    {char:'ä¹Ÿ',pinyin:'yÄ›',meaning:'also, too',strokes:3,radical:'ä¹™',hsk:1},
    {char:'èƒ½',pinyin:'nÃ©ng',meaning:'can, ability',strokes:10,radical:'å¶',hsk:1},
    {char:'ä¸‹',pinyin:'xiÃ ',meaning:'down, below',strokes:3,radical:'ä¸€',hsk:1},
    {char:'è¿‡',pinyin:'guÃ²',meaning:'to pass, past',strokes:6,radical:'è¾¶',hsk:1},
    {char:'å­',pinyin:'zÇ',meaning:'child, son',strokes:3,radical:'å­',hsk:1},
    {char:'è¯´',pinyin:'shuÅ',meaning:'to speak, say',strokes:9,radical:'è® ',hsk:1},
    {char:'äº§',pinyin:'chÇn',meaning:'to produce, product',strokes:6,radical:'äº ',hsk:2},
    {char:'ç§',pinyin:'zhÇ’ng',meaning:'kind, type, seed',strokes:9,radical:'ç¦¾',hsk:2},
    {char:'é¢',pinyin:'miÃ n',meaning:'face, surface, noodles',strokes:9,radical:'é¢',hsk:1},
    {char:'è€Œ',pinyin:'Ã©r',meaning:'and, but',strokes:6,radical:'è€Œ',hsk:2},
    {char:'æ–¹',pinyin:'fÄng',meaning:'direction, square, method',strokes:4,radical:'æ–¹',hsk:1},
    {char:'å',pinyin:'hÃ²u',meaning:'after, behind',strokes:6,radical:'å£',hsk:1},
    {char:'å¤š',pinyin:'duÅ',meaning:'many, much',strokes:6,radical:'å¤•',hsk:1},
    {char:'å®š',pinyin:'dÃ¬ng',meaning:'to decide, fixed',strokes:8,radical:'å®€',hsk:2},
    {char:'è¡Œ',pinyin:'xÃ­ng',meaning:'to walk, line, OK',strokes:6,radical:'å½³',hsk:1},
    {char:'å­¦',pinyin:'xuÃ©',meaning:'to learn, study',strokes:8,radical:'å­',hsk:1},
    {char:'æ³•',pinyin:'fÇ',meaning:'method, law',strokes:8,radical:'æ°µ',hsk:2},
    {char:'æ‰€',pinyin:'suÇ’',meaning:'place, that which',strokes:8,radical:'æˆ·',hsk:2},
    {char:'æ°‘',pinyin:'mÃ­n',meaning:'people, citizen',strokes:5,radical:'æ°',hsk:2},
    {char:'å¾—',pinyin:'dÃ©',meaning:'to get, obtain',strokes:11,radical:'å½³',hsk:1},
    {char:'ç»',pinyin:'jÄ«ng',meaning:'to pass, experience',strokes:8,radical:'çºŸ',hsk:2},
    {char:'å',pinyin:'shÃ­',meaning:'ten',strokes:2,radical:'å',hsk:1},
    {char:'ä¸‰',pinyin:'sÄn',meaning:'three',strokes:3,radical:'ä¸€',hsk:1},
    {char:'ä¹‹',pinyin:'zhÄ«',meaning:'of, it',strokes:3,radical:'ä¸¶',hsk:3},
    {char:'è¿›',pinyin:'jÃ¬n',meaning:'to enter, advance',strokes:7,radical:'è¾¶',hsk:1},
    {char:'ç€',pinyin:'zhe',meaning:'ongoing action particle',strokes:11,radical:'ç¾Š',hsk:2},
    {char:'ç­‰',pinyin:'dÄ›ng',meaning:'to wait, etc.',strokes:12,radical:'ç«¹',hsk:1},
    {char:'éƒ¨',pinyin:'bÃ¹',meaning:'part, department',strokes:10,radical:'é‚‘',hsk:2},
    {char:'åº¦',pinyin:'dÃ¹',meaning:'degree, measure',strokes:9,radical:'å¹¿',hsk:2},
    {char:'å®¶',pinyin:'jiÄ',meaning:'home, family',strokes:10,radical:'å®€',hsk:1},
    {char:'ç”µ',pinyin:'diÃ n',meaning:'electricity',strokes:5,radical:'ç”°',hsk:1},
    {char:'åŠ›',pinyin:'lÃ¬',meaning:'power, strength',strokes:2,radical:'åŠ›',hsk:2},
    {char:'é‡Œ',pinyin:'lÇ',meaning:'inside, mile',strokes:7,radical:'é‡Œ',hsk:1},
    {char:'å¦‚',pinyin:'rÃº',meaning:'if, like',strokes:6,radical:'å¥³',hsk:2},
    {char:'æ°´',pinyin:'shuÇ',meaning:'water',strokes:4,radical:'æ°´',hsk:1},
    {char:'åŒ–',pinyin:'huÃ ',meaning:'to change, transform',strokes:4,radical:'äº»',hsk:2},
    {char:'é«˜',pinyin:'gÄo',meaning:'high, tall',strokes:10,radical:'é«˜',hsk:1},
    {char:'è‡ª',pinyin:'zÃ¬',meaning:'self, from',strokes:6,radical:'è‡ª',hsk:2},
    {char:'äºŒ',pinyin:'Ã¨r',meaning:'two',strokes:2,radical:'äºŒ',hsk:1},
    {char:'ç†',pinyin:'lÇ',meaning:'reason, principle',strokes:11,radical:'ç‹',hsk:2},
    {char:'èµ·',pinyin:'qÇ',meaning:'to rise, start',strokes:10,radical:'èµ°',hsk:1},
    {char:'å°',pinyin:'xiÇo',meaning:'small, little',strokes:3,radical:'å°',hsk:1},
    {char:'ç‰©',pinyin:'wÃ¹',meaning:'thing, object',strokes:8,radical:'ç‰›',hsk:2},
    {char:'ç°',pinyin:'xiÃ n',meaning:'now, appear',strokes:8,radical:'ç‹',hsk:1},
    {char:'å®',pinyin:'shÃ­',meaning:'real, actual',strokes:8,radical:'å®€',hsk:2},
    {char:'åŠ ',pinyin:'jiÄ',meaning:'to add, plus',strokes:5,radical:'åŠ›',hsk:1},
    {char:'é‡',pinyin:'liÃ ng',meaning:'quantity, measure',strokes:12,radical:'é‡Œ',hsk:2},
    {char:'éƒ½',pinyin:'dÅu',meaning:'all, capital city',strokes:10,radical:'é‚‘',hsk:1},
    {char:'ä¸¤',pinyin:'liÇng',meaning:'two, both',strokes:7,radical:'ä¸€',hsk:1},
    {char:'ä½“',pinyin:'tÇ',meaning:'body, form',strokes:7,radical:'äº»',hsk:2},
    {char:'åˆ¶',pinyin:'zhÃ¬',meaning:'to make, system',strokes:8,radical:'åˆ€',hsk:3},
    {char:'æœº',pinyin:'jÄ«',meaning:'machine, opportunity',strokes:6,radical:'æœ¨',hsk:1},
    {char:'å½“',pinyin:'dÄng',meaning:'when, should',strokes:6,radical:'å½',hsk:2},
    {char:'ä½¿',pinyin:'shÇ',meaning:'to use, make',strokes:8,radical:'äº»',hsk:2},
    {char:'ç‚¹',pinyin:'diÇn',meaning:'point, dot, oclock',strokes:9,radical:'ç¬',hsk:1},
    {char:'ä»',pinyin:'cÃ³ng',meaning:'from, follow',strokes:4,radical:'äºº',hsk:2},
    {char:'ä¸š',pinyin:'yÃ¨',meaning:'industry, business',strokes:5,radical:'ä¸€',hsk:2},
    {char:'æœ¬',pinyin:'bÄ›n',meaning:'book, root, origin',strokes:5,radical:'æœ¨',hsk:1},
  ],
  radicals: [
    {char:'äºº',pinyin:'rÃ©n',meaning:'person (radical)',strokes:2,radical:'äºº',hsk:1},
    {char:'äº»',pinyin:'rÃ©n',meaning:'person (variant)',strokes:2,radical:'äº»',hsk:'-'},
    {char:'å£',pinyin:'kÇ’u',meaning:'mouth',strokes:3,radical:'å£',hsk:1},
    {char:'æ—¥',pinyin:'rÃ¬',meaning:'sun/day',strokes:4,radical:'æ—¥',hsk:1},
    {char:'æœˆ',pinyin:'yuÃ¨',meaning:'moon/month',strokes:4,radical:'æœˆ',hsk:1},
    {char:'å±±',pinyin:'shÄn',meaning:'mountain',strokes:3,radical:'å±±',hsk:1},
    {char:'æ°´',pinyin:'shuÇ',meaning:'water',strokes:4,radical:'æ°´',hsk:1},
    {char:'æ°µ',pinyin:'shuÇ',meaning:'water (variant)',strokes:3,radical:'æ°µ',hsk:'-'},
    {char:'ç«',pinyin:'huÇ’',meaning:'fire',strokes:4,radical:'ç«',hsk:1},
    {char:'ç¬',pinyin:'huÇ’',meaning:'fire (bottom)',strokes:4,radical:'ç¬',hsk:'-'},
    {char:'æœ¨',pinyin:'mÃ¹',meaning:'wood/tree',strokes:4,radical:'æœ¨',hsk:1},
    {char:'é‡‘',pinyin:'jÄ«n',meaning:'metal/gold',strokes:8,radical:'é‡‘',hsk:2},
    {char:'é’…',pinyin:'jÄ«n',meaning:'metal (variant)',strokes:5,radical:'é’…',hsk:'-'},
    {char:'åœŸ',pinyin:'tÇ”',meaning:'earth/soil',strokes:3,radical:'åœŸ',hsk:1},
    {char:'æ‰‹',pinyin:'shÇ’u',meaning:'hand',strokes:4,radical:'æ‰‹',hsk:1},
    {char:'æ‰Œ',pinyin:'shÇ’u',meaning:'hand (variant)',strokes:3,radical:'æ‰Œ',hsk:'-'},
    {char:'å¿ƒ',pinyin:'xÄ«n',meaning:'heart/mind',strokes:4,radical:'å¿ƒ',hsk:1},
    {char:'å¿„',pinyin:'xÄ«n',meaning:'heart (variant)',strokes:3,radical:'å¿„',hsk:'-'},
    {char:'å¥³',pinyin:'nÇš',meaning:'female/woman',strokes:3,radical:'å¥³',hsk:1},
    {char:'å­',pinyin:'zÇ',meaning:'child/son',strokes:3,radical:'å­',hsk:1},
    {char:'ç›®',pinyin:'mÃ¹',meaning:'eye',strokes:5,radical:'ç›®',hsk:2},
    {char:'è€³',pinyin:'Ä›r',meaning:'ear',strokes:6,radical:'è€³',hsk:1},
    {char:'è¶³',pinyin:'zÃº',meaning:'foot',strokes:7,radical:'è¶³',hsk:2},
    {char:'è® ',pinyin:'yÃ¡n',meaning:'speech (variant)',strokes:2,radical:'è® ',hsk:'-'},
    {char:'è¨€',pinyin:'yÃ¡n',meaning:'speech/word',strokes:7,radical:'è¨€',hsk:2},
    {char:'è‰',pinyin:'cÇo',meaning:'grass (è‰¹ radical)',strokes:9,radical:'è‰¹',hsk:2},
    {char:'è™«',pinyin:'chÃ³ng',meaning:'insect',strokes:6,radical:'è™«',hsk:2},
    {char:'é¸Ÿ',pinyin:'niÇo',meaning:'bird',strokes:5,radical:'é¸Ÿ',hsk:1},
    {char:'é±¼',pinyin:'yÃº',meaning:'fish',strokes:8,radical:'é±¼',hsk:1},
    {char:'é—¨',pinyin:'mÃ©n',meaning:'door/gate',strokes:3,radical:'é—¨',hsk:1},
    {char:'å®€',pinyin:'miÃ¡n',meaning:'roof radical',strokes:3,radical:'å®€',hsk:'-'},
    {char:'åŠ›',pinyin:'lÃ¬',meaning:'strength/power',strokes:2,radical:'åŠ›',hsk:2},
    {char:'åˆ€',pinyin:'dÄo',meaning:'knife',strokes:2,radical:'åˆ€',hsk:2},
    {char:'å¼“',pinyin:'gÅng',meaning:'bow (weapon)',strokes:3,radical:'å¼“',hsk:3},
    {char:'ç³¸',pinyin:'mÃ¬',meaning:'silk/thread',strokes:6,radical:'ç³¸',hsk:'-'},
    {char:'çºŸ',pinyin:'sÄ«',meaning:'silk (variant)',strokes:3,radical:'çºŸ',hsk:'-'},
  ],
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  STATE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let currentLevel = 'top100';
let currentIdx = 0;
let strokes = [];
let currentStroke = null;
let ghostOn = true;
let gridOn = true;
let mastery = {}; // char -> 0..3
let sessionPracticed = new Set();
let sessionMastered = new Set();

function getChars() { return DB[currentLevel] || []; }
function currentChar() { return getChars()[currentIdx]; }

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  CANVAS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const canvas = document.getElementById('drawCanvas');
const ctx = canvas.getContext('2d');
const wrap = document.getElementById('canvasWrap');
const ghost = document.getElementById('ghostEl');

function resizeCanvas() {
  const vw = window.innerWidth;
  const vh = window.innerHeight;
  const cellSize = Math.min(Math.floor(Math.min(vw - 440, vh - 180)), 360);
  const cell = Math.max(cellSize, 200);

  const item = currentChar();
  const charLen = item ? [...item.char].length : 1;
  const cols = Math.min(charLen, 4); // max 4 wide before wrapping
  const rows = Math.ceil(charLen / 4);

  const W = cell * cols;
  const H = cell * rows;

  wrap.style.width = W + 'px';
  wrap.style.height = H + 'px';
  canvas.width = W;
  canvas.height = H;

  // Ghost: fit all characters in a single line, font sized to cell height
  ghost.style.fontSize = (cell * 0.72) + 'px';
  ghost.style.lineHeight = '1';
  ghost.style.letterSpacing = '0.02em';
  ghost.style.flexWrap = 'wrap';
  ghost.style.whiteSpace = rows > 1 ? 'normal' : 'nowrap';

  drawGridSvg(W, H, cell);
  redraw();
}

function drawGridSvg(W, H, cell) {
  const svg = document.getElementById('gridSvg');
  let html = '';
  const cols = Math.round(W / cell);
  const rows = Math.round(H / cell);
  const arrowColor = 'rgba(160,80,60,0.9)';
  const margin = cell * 0.1;
  const innerW = cell - margin*2;
  const innerH = cell - margin*2;

  for (let col = 0; col < cols; col++) {
    for (let row = 0; row < rows; row++) {
      const ox = col * cell;
      const oy = row * cell;
      const step = cell / 4;

      // Sub-grid lines
      for (let x = step; x < cell; x += step) {
        html += `<line x1="${ox+x}" y1="${oy}" x2="${ox+x}" y2="${oy+cell}" stroke="rgba(160,120,60,0.09)" stroke-width="0.5"/>`;
      }
      for (let y = step; y < cell; y += step) {
        html += `<line x1="${ox}" y1="${oy+y}" x2="${ox+cell}" y2="${oy+y}" stroke="rgba(160,120,60,0.09)" stroke-width="0.5"/>`;
      }
      // Center cross
      html += `<line x1="${ox+cell/2}" y1="${oy}" x2="${ox+cell/2}" y2="${oy+cell}" stroke="rgba(160,120,60,0.2)" stroke-width="1"/>`;
      html += `<line x1="${ox}" y1="${oy+cell/2}" x2="${ox+cell}" y2="${oy+cell/2}" stroke="rgba(160,120,60,0.2)" stroke-width="1"/>`;
      // Diagonals
      html += `<line x1="${ox}" y1="${oy}" x2="${ox+cell}" y2="${oy+cell}" stroke="rgba(160,120,60,0.08)" stroke-width="0.5"/>`;
      html += `<line x1="${ox+cell}" y1="${oy}" x2="${ox}" y2="${oy+cell}" stroke="rgba(160,120,60,0.08)" stroke-width="0.5"/>`;
      // Cell border
      html += `<rect x="${ox+0.5}" y="${oy+0.5}" width="${cell-1}" height="${cell-1}" fill="none" stroke="rgba(154,125,58,0.3)" stroke-width="1"/>`;
      const lx = ox + cell - 4;
      const ly = oy + cell - 4;
    }
  }
  // Outer border
  html += `<rect x="1" y="1" width="${W-2}" height="${H-2}" fill="none" stroke="rgba(154,125,58,0.5)" stroke-width="1.5"/>`;
  svg.innerHTML = html;
  svg.setAttribute('viewBox', `0 0 ${W} ${H}`);
  svg.style.display = gridOn ? '' : 'none';
}

function getPos(e) {
  const rect = canvas.getBoundingClientRect();
  const scaleX = canvas.width / rect.width;
  const scaleY = canvas.height / rect.height;
  const src = e.touches ? e.touches[0] : e;
  return { x: (src.clientX - rect.left) * scaleX, y: (src.clientY - rect.top) * scaleY };
}

canvas.addEventListener('mousedown', e => {
  e.preventDefault();
  currentStroke = [getPos(e)];
});
canvas.addEventListener('mousemove', e => {
  if (!currentStroke) return;
  currentStroke.push(getPos(e));
  redraw();
  // draw current stroke live
  drawStroke(currentStroke, getBrush());
});
canvas.addEventListener('mouseup', endDraw);
canvas.addEventListener('mouseleave', endDraw);
canvas.addEventListener('touchstart', e => { e.preventDefault(); currentStroke = [getPos(e)]; }, { passive: false });
canvas.addEventListener('touchmove', e => {
  e.preventDefault();
  if (!currentStroke) return;
  currentStroke.push(getPos(e));
  redraw();
  drawStroke(currentStroke, getBrush());
}, { passive: false });
canvas.addEventListener('touchend', endDraw);

function endDraw() {
  if (!currentStroke || currentStroke.length < 1) return;
  strokes.push({ points: currentStroke, size: getBrush() });
  currentStroke = null;
  sessionPracticed.add(currentChar().char);
  document.getElementById('sessionCount').textContent = sessionPracticed.size;
  redraw();
}

function getBrush() { return parseInt(document.getElementById('brushSize').value); }

function drawStroke(pts, size) {
  if (!pts || pts.length === 0) return;
  ctx.save();
  ctx.strokeStyle = '#2d2d6b';
  ctx.lineWidth = size;
  ctx.lineCap = 'round';
  ctx.lineJoin = 'round';
  ctx.beginPath();
  ctx.moveTo(pts[0].x, pts[0].y);
  for (let i = 1; i < pts.length; i++) ctx.lineTo(pts[i].x, pts[i].y);
  ctx.stroke();
  ctx.restore();
}

function redraw() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  for (const s of strokes) drawStroke(s.points, s.size);
}

function clearCanvas() { strokes = []; currentStroke = null; redraw(); }

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  UI UPDATE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function updateUI() {
  const item = currentChar();
  if (!item) return;
  const c = item.char;
  resizeCanvas();
  updateYTPanel();

  // Reference
  const refEl = document.getElementById('refChar');
  refEl.textContent = c;
  // Scale reference font based on char count
  const clen = [...c].length;
  const baseFs = clen <= 1 ? 110 : clen <= 2 ? 60 : clen <= 3 ? 40 : 30;
  refEl.style.fontSize = baseFs + 'px';
  refEl.style.letterSpacing = clen > 1 ? '0.02em' : '';
  document.getElementById('refPinyin').textContent = item.pinyin;
  document.getElementById('refMeaning').textContent = item.meaning;

  // Ghost
  ghost.textContent = ghostOn ? c : '';

  // Right panel
  document.getElementById('rpChar').textContent = c;
  document.getElementById('rpPinyin').textContent = item.pinyin;
  document.getElementById('rpStrokes').textContent = item.strokes || '?';
  document.getElementById('rpRadical').textContent = item.radical || '-';
  document.getElementById('rpHSK').textContent = item.hsk || '-';
  document.getElementById('rpMeaning').textContent = item.meaning;

  // Mastery
  const m = mastery[c] || 0;
  const pct = Math.round(m / 3 * 100);
  document.getElementById('masteryPct').textContent = pct + '%';
  document.getElementById('masteryFill').style.width = pct + '%';

  // Stroke hint
  const hints = ['Write the character below, following the guide lines.',
    'Stroke order: topâ†’bottom, leftâ†’right. Horizontal before vertical (usually).',
    'Tip: Write the enclosing box last in most characters.',
    'Practice the character until it feels natural!'];

  // Progress
  const total = getChars().length;
  const done = Object.keys(mastery).filter(k => mastery[k] >= 1 && getChars().some(x => x.char === k)).length;
  document.getElementById('progressTxt').textContent = `${done}/${total} started`;

  // Grid highlight
  document.querySelectorAll('.cpill').forEach((el, i) => {
    el.classList.toggle('active', i === currentIdx);
  });
  // Scroll active into view
  const active = document.querySelector('.cpill.active');
  if (active) active.scrollIntoView({ block: 'nearest' });
}

function buildGrid(chars) {
  const grid = document.getElementById('charGrid');
  grid.innerHTML = '';
  chars.forEach((item, i) => {
    const pill = document.createElement('div');
    pill.className = 'cpill' + (i === currentIdx ? ' active' : '') + (mastery[item.char] ? ' done' : '');
    pill.textContent = item.char;
    pill.title = item.pinyin + ' â€” ' + item.meaning;
    pill.addEventListener('click', () => {
      currentIdx = i;
      clearCanvas();
      updateUI();
    });
    grid.appendChild(pill);
  });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  CONTROLS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
document.getElementById('levelSelect').addEventListener('change', function() {
  currentLevel = this.value;
  currentIdx = 0;
  clearCanvas();
  buildGrid(getChars());
  updateUI();
});

document.getElementById('prevBtn').addEventListener('click', () => {
  currentIdx = (currentIdx - 1 + getChars().length) % getChars().length;
  clearCanvas(); updateUI();
});
document.getElementById('nextBtn').addEventListener('click', () => {
  currentIdx = (currentIdx + 1) % getChars().length;
  clearCanvas(); updateUI();
});
document.getElementById('nextCharBtn').addEventListener('click', () => {
  currentIdx = (currentIdx + 1) % getChars().length;
  clearCanvas(); updateUI();
});
document.getElementById('randBtn').addEventListener('click', () => {
  currentIdx = Math.floor(Math.random() * getChars().length);
  clearCanvas(); updateUI();
});
document.getElementById('clearBtn').addEventListener('click', clearCanvas);
document.getElementById('clearBtn2').addEventListener('click', clearCanvas);
document.getElementById('undoBtn').addEventListener('click', () => { strokes.pop(); redraw(); });
document.getElementById('undoBtn2').addEventListener('click', () => { strokes.pop(); redraw(); });

document.getElementById('brushSize').addEventListener('input', function() {
  document.getElementById('brushVal').textContent = this.value;
});

document.getElementById('ghostBtn').addEventListener('click', function() {
  ghostOn = !ghostOn;
  this.textContent = 'ğŸ‘ Ghost ' + (ghostOn ? 'ON' : 'OFF');
  updateUI();
});

document.getElementById('gridBtn').addEventListener('click', function() {
  gridOn = !gridOn;
  this.textContent = 'âŠ Grid ' + (gridOn ? 'ON' : 'OFF');
  resizeCanvas();
});

document.getElementById('searchInput').addEventListener('input', function() {
  const q = this.value.trim().toLowerCase();
  if (!q) { buildGrid(getChars()); return; }
  const filtered = getChars().filter(item =>
    item.char.includes(q) ||
    item.pinyin.toLowerCase().includes(q) ||
    item.meaning.toLowerCase().includes(q)
  );
  buildGrid(filtered);
});

function markChar(level) {
  const c = currentChar().char;
  mastery[c] = level;
  if (level >= 2) {
    sessionMastered.add(c);
    document.getElementById('masteredCount').textContent = sessionMastered.size;
  }
  // Update pill
  const pills = document.querySelectorAll('.cpill');
  if (pills[currentIdx]) {
    pills[currentIdx].classList.toggle('done', level > 0);
  }
  updateUI();
  // Auto next on mastered
  if (level === 3) {
    setTimeout(() => {
      currentIdx = (currentIdx + 1) % getChars().length;
      clearCanvas(); updateUI();
    }, 400);
  }
}

// Keyboard shortcuts
document.addEventListener('keydown', e => {
  if (e.target.tagName === 'INPUT') return;
  if (e.key === 'ArrowRight' || e.key === 'n') { currentIdx = (currentIdx+1)%getChars().length; clearCanvas(); updateUI(); }
  if (e.key === 'ArrowLeft' || e.key === 'p') { currentIdx = (currentIdx-1+getChars().length)%getChars().length; clearCanvas(); updateUI(); }
  if (e.key === 'c' || e.key === 'Delete') clearCanvas();
  if (e.key === 'z' && (e.ctrlKey || e.metaKey)) { strokes.pop(); redraw(); }
  if (e.key === 'g') { ghostOn=!ghostOn; document.getElementById('ghostBtn').textContent='ğŸ‘ Ghost '+(ghostOn?'ON':'OFF'); updateUI(); }
  if (e.key === '1') markChar(1);
  if (e.key === '2') markChar(2);
  if (e.key === '3') markChar(3);
});


// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  YOUTUBE VIDEO INTEGRATION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

// Specific YouTube video IDs for stroke order (high-quality videos)
// Channel: WriteMandarin, YellowBridge, Learn Chinese characters etc.
const YT_STROKE_IDS = {
  // Numbers
  'ä¸€':'ZreRhldYb20','äºŒ':'ZreRhldYb20','ä¸‰':'ZreRhldYb20','å››':'ZreRhldYb20',
  'äº”':'ZreRhldYb20','å…­':'ZreRhldYb20','ä¸ƒ':'ZreRhldYb20','å…«':'ZreRhldYb20',
  'ä¹':'ZreRhldYb20','å':'ZreRhldYb20',
};

let currentYTMode = 'stroke';

function getYTSearchQuery(char, mode) {
  if (mode === 'pronunciation') return encodeURIComponent(char + ' chinese pronunciation mandarin how to say');
  return encodeURIComponent(char + ' ç¬”é¡º chinese stroke order how to write');
}

function getYTOpenUrl(char, mode) {
  return 'https://www.youtube.com/results?search_query=' + getYTSearchQuery(char, mode);
}

function updateYTPanel() {
  const item = currentChar();
  if (!item) return;
  const char = item.char;

  document.getElementById('ytCharLabel').textContent = char;

  // Build search URLs
  const strokeUrl = getYTOpenUrl(char, 'stroke');
  const pronUrl = getYTOpenUrl(char, 'pronunciation');

  document.getElementById('ytLink1').href = strokeUrl;
  document.getElementById('ytLink2').href = pronUrl;
  document.getElementById('ytLink3').href = strokeUrl;

  // Update placeholder text and thumbnail
  const placeholder = document.getElementById('ytPlaceholder');
  placeholder.style.display = 'flex';
  document.getElementById('ytPlaceholderText').textContent = 'Click to search stroke order for "' + char + '"';
  document.getElementById('ytPlaceholderChar').textContent = char;

  // Remove old iframe
  const wrap = document.getElementById('ytEmbedWrap');
  const old = wrap.querySelector('iframe');
  if (old) old.remove();

  // If we have a known video ID, show embed ready to load
  const vid = YT_STROKE_IDS[char];
  if (vid) {
    document.getElementById('ytPlaceholderText').textContent = 'Click â–¶ to play stroke order video';
    placeholder.onclick = () => loadYTEmbed(vid);
  } else {
    placeholder.onclick = () => window.open(strokeUrl, '_blank');
    document.getElementById('ytPlaceholderText').textContent = 'Click to search on YouTube â†—';
  }
}

function loadYTEmbed(videoId) {
  const wrap = document.getElementById('ytEmbedWrap');
  document.getElementById('ytPlaceholder').style.display = 'none';
  const old = wrap.querySelector('iframe');
  if (old) old.remove();
  const iframe = document.createElement('iframe');
  iframe.src = 'https://www.youtube.com/embed/' + videoId + '?autoplay=1&rel=0';
  iframe.allow = 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture';
  iframe.allowFullscreen = true;
  wrap.appendChild(iframe);
}

document.getElementById('ytLink1').addEventListener('click', e => {
  e.preventDefault();
  window.open(document.getElementById('ytLink1').href, '_blank');
});
document.getElementById('ytLink2').addEventListener('click', e => {
  e.preventDefault();
  window.open(document.getElementById('ytLink2').href, '_blank');
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  INIT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
buildGrid(getChars());
updateUI();
resizeCanvas();
window.addEventListener('resize', resizeCanvas);
</script>
</body>
</html>
